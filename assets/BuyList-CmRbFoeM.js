import{P as J,r as h,o as O,w as U,c as p,x as a,e as r,j as _,B as n,R as t,t as w,d as u,K as B,F as D,i as A,k as $,p as q}from"./vue-vendor-D8N656sj.js";import{q as E,a as g,r as z,g as y,h as T,f as F,n as K}from"./primevue-DrPXlnFP.js";import{_ as P}from"./BreadcrumbNav.vue_vue_type_script_setup_true_lang-DN_huglN.js";import{G,D as R,C as M}from"./vue3-smooth-dnd.esm-cfhipf-1.js";import{d as L,_ as H}from"./index-Dm5LJ7u1.js";import{D as Q}from"./download-ZGrC78Ec.js";import{U as W}from"./upload-DJ_SFfpV.js";import{P as X}from"./plus-BS-ngSAI.js";import{T as C}from"./trash-2-DFLe-_-x.js";const Y={class:"max-w-2xl mx-auto px-4 py-4"},Z={class:"flex flex-wrap gap-2 justify-end mb-6"},ee={class:"inline-flex items-center cursor-pointer"},ae={class:"bg-white p-6 rounded-lg shadow-md mb-6"},te={key:0,class:"text-red-500 text-sm mt-2"},se={key:0,class:"bg-white p-6 rounded-lg shadow-md text-center text-gray-500"},le={class:"bg-white p-4 rounded-lg shadow-sm flex items-center justify-between"},oe={class:"flex items-center flex-grow"},re={class:"drag-handle cursor-move text-gray-400 hover:text-blue-500 transition mr-2",title:"Arrastrar para reordenar"},ne={key:1,class:"mt-6 text-center"},ie={components:{ShoppingCart:L}},ce=J({...ie,__name:"BuyList",setup(de){const o=h([]),m=h(""),c=h(""),b=E();O(()=>{const s=localStorage.getItem("shoppingList");s&&(o.value=JSON.parse(s))});const d=()=>{localStorage.setItem("shoppingList",JSON.stringify(o.value))};U(o,d,{deep:!0});const x=()=>{const s=m.value.trim();if(s===""){c.value="El nombre del artículo no puede estar vacío.";return}if(o.value.some(l=>l.name.toLowerCase()===s.toLowerCase())){c.value="Este artículo ya está en tu lista.";return}const e={id:Date.now(),name:s,bought:!1};o.value.push(e),m.value="",c.value="",d()},S=s=>{b.require({message:"¿Seguro que deseas eliminar este artículo?",header:"Confirmar eliminación",acceptLabel:"Sí, eliminar",rejectLabel:"Cancelar",acceptClass:"p-button-danger",rejectClass:"p-button-warning",accept:()=>{o.value=o.value.filter(e=>e.id!==s),d()}})},k=()=>{b.require({message:"¿Estás seguro de que quieres limpiar toda la lista?",header:"Confirmar limpieza",acceptLabel:"Sí, limpiar",rejectLabel:"Cancelar",acceptClass:"p-button-danger",rejectClass:"p-button-warning",accept:()=>{o.value=[],d()}})};function j(s){if(!s||s.removedIndex===null&&s.addedIndex===null)return;const e=[...o.value],[l]=e.splice(s.removedIndex,1);e.splice(s.addedIndex,0,l),o.value=e,d()}const N=()=>{const s=JSON.stringify(o.value,null,2),e=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(e),i=document.createElement("a");i.href=l,i.download="lista-compras.json",i.click(),URL.revokeObjectURL(l)},I=s=>{const e=s.target;if(!e.files||!e.files[0])return;const l=e.files[0],i=new FileReader;i.onload=V=>{try{const f=JSON.parse(V.target?.result);if(!Array.isArray(f)||!f.every(v=>typeof v.id=="number"&&typeof v.name=="string"&&typeof v.bought=="boolean")){c.value="Archivo JSON inválido.";return}o.value=f,d(),c.value=""}catch{c.value="No se pudo leer el archivo JSON."}},i.readAsText(l)};return(s,e)=>(u(),p("div",null,[a(P),r("div",Y,[e[2]||(e[2]=r("div",{class:"text-center mb-8"},[r("h1",{class:"text-3xl font-bold text-center text-gray-800 mb-2"}," 🛒 Lista de compras ")],-1)),r("div",Z,[a(t(g),{onClick:N,label:"Descargar JSON",outlined:"",size:"small"},{icon:n(()=>[a(t(Q),{class:"w-4 h-4 mr-2"})]),_:1}),r("label",ee,[a(t(g),{label:"Cargar JSON",outlined:"",size:"small",class:"mr-2"},{icon:n(()=>[a(t(W),{class:"w-4 h-4 mr-2"})]),_:1}),r("input",{type:"file",accept:"application/json",onChange:I,class:"hidden"},null,32)])]),a(t(z)),r("div",ae,[a(t(F),null,{default:n(()=>[a(t(y),null,{default:n(()=>[a(t(L),{class:"w-5 h-5 text-gray-400"})]),_:1}),a(t(T),{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l),onKeyup:B(x,["enter"]),placeholder:"Escribe un nuevo artículo...",class:"flex-grow p-3 border-none focus:ring-2 focus:ring-blue-500"},null,8,["modelValue"]),a(t(y),null,{default:n(()=>[a(t(g),{onClick:x,disabled:!m.value.trim(),class:"rounded-md ml-0"},{icon:n(()=>[a(t(X),{class:"w-4 h-4"})]),_:1},8,["disabled"])]),_:1})]),_:1}),c.value?(u(),p("p",te,w(c.value),1)):_("",!0)]),o.value.length===0?(u(),p("div",se,e[1]||(e[1]=[r("p",null,"¡Tu lista de compras está vacía! Añade algunos artículos.",-1)]))):_("",!0),a(t(M),{tag:"ul",class:"space-y-3","drag-handle-selector":".drag-handle",onDrop:j},{default:n(()=>[(u(!0),p(D,null,A(o.value,l=>(u(),$(t(R),{key:l.id},{default:n(()=>[r("li",le,[r("div",oe,[r("span",re,[a(t(G),{class:"w-4 h-4"})]),a(t(K),{modelValue:l.bought,"onUpdate:modelValue":i=>l.bought=i,onChange:d,class:"mr-3",binary:!0},null,8,["modelValue","onUpdate:modelValue"]),r("span",{class:q([{"line-through text-gray-500":l.bought,"text-gray-800":!l.bought},"text-lg flex-grow"])},w(l.name),3)]),a(t(g),{onClick:i=>S(l.id),severity:"danger",class:"ml-4",text:""},{icon:n(()=>[a(t(C),{class:"w-4 h-4"})]),_:2},1032,["onClick"])])]),_:2},1024))),128))]),_:1}),o.value.length>0?(u(),p("div",ne,[a(t(g),{onClick:k,label:"Limpiar Lista",severity:"danger"},{icon:n(()=>[a(t(C),{class:"w-4 h-4 mr-2"})]),_:1})])):_("",!0)])]))}}),xe=H(ce,[["__scopeId","data-v-7771989d"]]);export{xe as default};
