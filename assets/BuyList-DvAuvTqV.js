import{P as J,r as h,o as O,w as V,c as p,x as l,e as n,j as b,R as o,B as m,t as y,d as u,K as B,F as A,i as U,k as $,p as q}from"./vue-vendor-D8N656sj.js";import{q as D,a as g,r as E,g as w,h as z,f as F,n as K}from"./primevue-qOHAer5i.js";import{_ as R}from"./BreadcrumbNav.vue_vue_type_script_setup_true_lang-rqNnxdTD.js";import{D as T,C as M}from"./vue3-smooth-dnd.esm-DCVSUFqs.js";import{b as C,_ as P}from"./index-D-CNp7HO.js";const G={class:"max-w-2xl mx-auto px-4 py-4"},H={class:"flex flex-wrap gap-2 justify-end mb-6"},Q={class:"inline-flex items-center cursor-pointer"},W={class:"bg-white p-6 rounded-lg shadow-md mb-6"},X={key:0,class:"text-red-500 text-sm mt-2"},Y={key:0,class:"bg-white p-6 rounded-lg shadow-md text-center text-gray-500"},Z={class:"bg-white p-4 rounded-lg shadow-sm flex items-center justify-between"},ee={class:"flex items-center flex-grow"},ae={key:1,class:"mt-6 text-center"},te={components:{ShoppingCart:C}},se=J({...te,__name:"BuyList",setup(le){const s=h([]),d=h(""),i=h(""),x=D();O(()=>{const a=localStorage.getItem("shoppingList");a&&(s.value=JSON.parse(a))});const c=()=>{localStorage.setItem("shoppingList",JSON.stringify(s.value))};V(s,c,{deep:!0});const _=()=>{const a=d.value.trim();if(a===""){i.value="El nombre del artículo no puede estar vacío.";return}if(s.value.some(t=>t.name.toLowerCase()===a.toLowerCase())){i.value="Este artículo ya está en tu lista.";return}const e={id:Date.now(),name:a,bought:!1};s.value.push(e),d.value="",i.value="",c()},L=a=>{x.require({message:"¿Seguro que deseas eliminar este artículo?",header:"Confirmar eliminación",icon:"pi pi-exclamation-triangle",acceptLabel:"Sí, eliminar",rejectLabel:"Cancelar",acceptIcon:"pi pi-trash",rejectIcon:"pi pi-times-circle",acceptClass:"p-button-danger",rejectClass:"p-button-warning",accept:()=>{s.value=s.value.filter(e=>e.id!==a),c()}})},I=()=>{x.require({message:"¿Estás seguro de que quieres limpiar toda la lista?",header:"Confirmar limpieza",icon:"pi pi-exclamation-triangle",acceptLabel:"Sí, limpiar",rejectLabel:"Cancelar",acceptIcon:"pi pi-trash",rejectIcon:"pi pi-times-circle",acceptClass:"p-button-danger",rejectClass:"p-button-warning",accept:()=>{s.value=[],c()}})};function S(a){if(!a||a.removedIndex===null&&a.addedIndex===null)return;const e=[...s.value],[t]=e.splice(a.removedIndex,1);e.splice(a.addedIndex,0,t),s.value=e,c()}const j=()=>{const a=JSON.stringify(s.value,null,2),e=new Blob([a],{type:"application/json"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="lista-compras.json",r.click(),URL.revokeObjectURL(t)},k=a=>{const e=a.target;if(!e.files||!e.files[0])return;const t=e.files[0],r=new FileReader;r.onload=N=>{try{const f=JSON.parse(N.target?.result);if(!Array.isArray(f)||!f.every(v=>typeof v.id=="number"&&typeof v.name=="string"&&typeof v.bought=="boolean")){i.value="Archivo JSON inválido.";return}s.value=f,c(),i.value=""}catch{i.value="No se pudo leer el archivo JSON."}},r.readAsText(t)};return(a,e)=>(u(),p("div",null,[l(R),n("div",G,[e[3]||(e[3]=n("div",{class:"text-center mb-8"},[n("h1",{class:"text-3xl font-bold text-center text-gray-800 mb-2"}," 🛒 Lista de compras ")],-1)),n("div",H,[l(o(g),{onClick:j,icon:"pi pi-download",label:"Descargar JSON",outlined:"",size:"small"}),n("label",Q,[l(o(g),{icon:"pi pi-upload",label:"Cargar JSON",outlined:"",size:"small",class:"mr-2"}),n("input",{type:"file",accept:"application/json",onChange:k,class:"hidden"},null,32)])]),l(o(E)),n("div",W,[l(o(F),null,{default:m(()=>[l(o(w),null,{default:m(()=>[l(o(C),{class:"w-5 h-5 text-gray-400"})]),_:1}),l(o(z),{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),onKeyup:B(_,["enter"]),placeholder:"Escribe un nuevo artículo...",class:"flex-grow p-3 border-none focus:ring-2 focus:ring-blue-500"},null,8,["modelValue"]),l(o(w),null,{default:m(()=>[l(o(g),{onClick:_,disabled:!d.value.trim(),icon:"pi pi-plus",class:"rounded-md ml-0"},null,8,["disabled"])]),_:1})]),_:1}),i.value?(u(),p("p",X,y(i.value),1)):b("",!0)]),s.value.length===0?(u(),p("div",Y,e[1]||(e[1]=[n("p",null,"¡Tu lista de compras está vacía! Añade algunos artículos.",-1)]))):b("",!0),l(o(M),{tag:"ul",class:"space-y-3","drag-handle-selector":".drag-handle",onDrop:S},{default:m(()=>[(u(!0),p(A,null,U(s.value,t=>(u(),$(o(T),{key:t.id},{default:m(()=>[n("li",Z,[n("div",ee,[e[2]||(e[2]=n("span",{class:"drag-handle cursor-move text-gray-400 hover:text-blue-500 transition mr-2",title:"Arrastrar para reordenar"},[n("i",{class:"pi pi-bars"})],-1)),l(o(K),{modelValue:t.bought,"onUpdate:modelValue":r=>t.bought=r,onChange:c,class:"mr-3",binary:!0},null,8,["modelValue","onUpdate:modelValue"]),n("span",{class:q([{"line-through text-gray-500":t.bought,"text-gray-800":!t.bought},"text-lg flex-grow"])},y(t.name),3)]),l(o(g),{onClick:r=>L(t.id),icon:"pi pi-trash",severity:"danger",class:"ml-4",text:""},null,8,["onClick"])])]),_:2},1024))),128))]),_:1}),s.value.length>0?(u(),p("div",ae,[l(o(g),{onClick:I,label:"Limpiar Lista",icon:"pi pi-trash",severity:"danger"})])):b("",!0)])]))}}),ue=P(se,[["__scopeId","data-v-95ec0e5e"]]);export{ue as default};
