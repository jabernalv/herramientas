import{P as V,r as b,o as J,w as O,c as m,e as t,x as o,B as d,A as B,f as A,j as h,R as n,H as D,t as w,F as E,i as U,d as u,k as $,p as q}from"./vue-vendor-DSKsDytq.js";import{D as z,a as g,E as F,y as C,B as T,x as H,k as K}from"./primevue-CM4O-dLP.js";import{C as M,D as R}from"./vue3-smooth-dnd.esm-DyDYc-3R.js";import{f as L,_ as P}from"./index-Cg_Qq_kg.js";const G={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},Q={class:"text-sm","aria-label":"Miga de pan"},W={class:"list-none p-0 inline-flex space-x-2"},X={class:"flex items-center"},Y={class:"max-w-2xl mx-auto px-4 py-4"},Z={class:"flex flex-wrap gap-2 justify-end mb-6"},ee={class:"inline-flex items-center cursor-pointer"},te={class:"bg-white p-6 rounded-lg shadow-md mb-6"},ae={key:0,class:"text-red-500 text-sm mt-2"},se={key:0,class:"bg-white p-6 rounded-lg shadow-md text-center text-gray-500"},le={class:"bg-white p-4 rounded-lg shadow-sm flex items-center justify-between"},oe={class:"flex items-center flex-grow"},ne={key:1,class:"mt-6 text-center"},re={components:{ShoppingCart:L}},ie=V({...re,__name:"BuyList",setup(ce){const l=b([]),p=b(""),i=b(""),_=z();J(()=>{const a=localStorage.getItem("shoppingList");a&&(l.value=JSON.parse(a))});const c=()=>{localStorage.setItem("shoppingList",JSON.stringify(l.value))};O(l,c,{deep:!0});const y=()=>{const a=p.value.trim();if(a===""){i.value="El nombre del artículo no puede estar vacío.";return}if(l.value.some(r=>r.name.toLowerCase()===a.toLowerCase())){i.value="Este artículo ya está en tu lista.";return}const e={id:Date.now(),name:a,bought:!1};l.value.push(e),p.value="",i.value="",c()},k=a=>{_.require({message:"¿Seguro que deseas eliminar este artículo?",header:"Confirmar eliminación",icon:"pi pi-exclamation-triangle",acceptLabel:"Sí, eliminar",rejectLabel:"Cancelar",acceptIcon:"pi pi-trash",rejectIcon:"pi pi-times-circle",acceptClass:"p-button-danger",rejectClass:"p-button-warning",accept:()=>{l.value=l.value.filter(e=>e.id!==a),c()}})},I=()=>{_.require({message:"¿Estás seguro de que quieres limpiar toda la lista?",header:"Confirmar limpieza",icon:"pi pi-exclamation-triangle",acceptLabel:"Sí, limpiar",rejectLabel:"Cancelar",acceptIcon:"pi pi-trash",rejectIcon:"pi pi-times-circle",acceptClass:"p-button-danger",rejectClass:"p-button-warning",accept:()=>{l.value=[],c()}})};function S(a){if(!a||a.removedIndex===null&&a.addedIndex===null)return;const e=[...l.value],[r]=e.splice(a.removedIndex,1);e.splice(a.addedIndex,0,r),l.value=e,c()}const j=()=>{const a=JSON.stringify(l.value,null,2),e=new Blob([a],{type:"application/json"}),r=URL.createObjectURL(e),s=document.createElement("a");s.href=r,s.download="lista-compras.json",s.click(),URL.revokeObjectURL(r)},N=a=>{const e=a.target;if(!e.files||!e.files[0])return;const r=e.files[0],s=new FileReader;s.onload=v=>{try{const f=JSON.parse(v.target?.result);if(!Array.isArray(f)||!f.every(x=>typeof x.id=="number"&&typeof x.name=="string"&&typeof x.bought=="boolean")){i.value="Archivo JSON inválido.";return}l.value=f,c(),i.value=""}catch{i.value="No se pudo leer el archivo JSON."}},s.readAsText(r)};return(a,e)=>{const r=A("router-link");return u(),m("div",null,[t("div",G,[t("nav",Q,[t("ol",W,[t("li",X,[o(r,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:d(()=>e[1]||(e[1]=[t("i",{class:"pi pi-home mr-1"},null,-1),B(" Herramientas ")])),_:1,__:[1]})]),e[2]||(e[2]=t("li",null,[t("i",{class:"pi pi-chevron-right text-gray-400"})],-1)),e[3]||(e[3]=t("li",{class:"text-gray-700"},"Lista de compras",-1))])])]),t("div",Y,[e[6]||(e[6]=t("div",{class:"text-center mb-8"},[t("h1",{class:"text-3xl font-bold text-center text-gray-800 mb-2"}," 🛒 Lista de compras ")],-1)),t("div",Z,[o(n(g),{onClick:j,icon:"pi pi-download",label:"Descargar JSON",outlined:"",size:"small"}),t("label",ee,[o(n(g),{icon:"pi pi-upload",label:"Cargar JSON",outlined:"",size:"small",class:"mr-2"}),t("input",{type:"file",accept:"application/json",onChange:N,class:"hidden"},null,32)])]),o(n(F)),t("div",te,[o(n(H),null,{default:d(()=>[o(n(C),null,{default:d(()=>[o(n(L),{class:"w-5 h-5 text-gray-400"})]),_:1}),o(n(T),{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),onKeyup:D(y,["enter"]),placeholder:"Escribe un nuevo artículo...",class:"flex-grow p-3 border-none focus:ring-2 focus:ring-blue-500"},null,8,["modelValue"]),o(n(C),null,{default:d(()=>[o(n(g),{onClick:y,disabled:!p.value.trim(),icon:"pi pi-plus",class:"rounded-md ml-0"},null,8,["disabled"])]),_:1})]),_:1}),i.value?(u(),m("p",ae,w(i.value),1)):h("",!0)]),l.value.length===0?(u(),m("div",se,e[4]||(e[4]=[t("p",null,"¡Tu lista de compras está vacía! Añade algunos artículos.",-1)]))):h("",!0),o(n(M),{tag:"ul",class:"space-y-3","drag-handle-selector":".drag-handle",onDrop:S},{default:d(()=>[(u(!0),m(E,null,U(l.value,s=>(u(),$(n(R),{key:s.id},{default:d(()=>[t("li",le,[t("div",oe,[e[5]||(e[5]=t("span",{class:"drag-handle cursor-move text-gray-400 hover:text-blue-500 transition mr-2",title:"Arrastrar para reordenar"},[t("i",{class:"pi pi-bars"})],-1)),o(n(K),{modelValue:s.bought,"onUpdate:modelValue":v=>s.bought=v,onChange:c,class:"mr-3",binary:!0},null,8,["modelValue","onUpdate:modelValue"]),t("span",{class:q([{"line-through text-gray-500":s.bought,"text-gray-800":!s.bought},"text-lg flex-grow"])},w(s.name),3)]),o(n(g),{onClick:v=>k(s.id),icon:"pi pi-trash",severity:"danger",class:"ml-4",text:""},null,8,["onClick"])])]),_:2},1024))),128))]),_:1}),l.value.length>0?(u(),m("div",ne,[o(n(g),{onClick:I,label:"Limpiar Lista",icon:"pi pi-trash",severity:"danger"})])):h("",!0)])])}}}),ge=P(ie,[["__scopeId","data-v-e597915e"]]);export{ge as default};
