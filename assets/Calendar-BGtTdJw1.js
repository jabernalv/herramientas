import{j as se,a as re,k as ie,l as ce,m as Q,n as de,o as Z,p as ue,q as G}from"./primevue-BjsjsmTx.js";import{e as fe}from"./exceljs.min-BO0RjN_l.js";import{c as N}from"./_commonjsHelpers-D6-XlEtG.js";import{F as pe,_ as me}from"./index-CH2nUG-2.js";import{N as ve,r as z,o as ee,w as ge,c as T,e as r,x as p,B as h,f as be,O as g,d as j,A as O,F as te,i as oe,t as P,p as he}from"./vue-vendor-Bqr_0FhS.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";var H={exports:{}},we=H.exports,ae;function xe(){return ae||(ae=1,function(X,m){(function(L,D){D()})(we,function(){function L(a,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function D(a,t,e){var o=new XMLHttpRequest;o.open("GET",a),o.responseType="blob",o.onload=function(){F(o.response,t,e)},o.onerror=function(){console.error("could not download file")},o.send()}function R(a){var t=new XMLHttpRequest;t.open("HEAD",a,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function w(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(t)}}var v=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof N=="object"&&N.global===N?N:void 0,B=v.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),F=v.saveAs||(typeof window!="object"||window!==v?function(){}:"download"in HTMLAnchorElement.prototype&&!B?function(a,t,e){var o=v.URL||v.webkitURL,l=document.createElement("a");t=t||a.name||"download",l.download=t,l.rel="noopener",typeof a=="string"?(l.href=a,l.origin===location.origin?w(l):R(l.href)?D(a,t,e):w(l,l.target="_blank")):(l.href=o.createObjectURL(a),setTimeout(function(){o.revokeObjectURL(l.href)},4e4),setTimeout(function(){w(l)},0))}:"msSaveOrOpenBlob"in navigator?function(a,t,e){if(t=t||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(L(a,e),t);else if(R(a))D(a,t,e);else{var o=document.createElement("a");o.href=a,o.target="_blank",setTimeout(function(){w(o)})}}:function(a,t,e,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof a=="string")return D(a,t,e);var l=a.type==="application/octet-stream",i=/constructor/i.test(v.HTMLElement)||v.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||l&&i||B)&&typeof FileReader<"u"){var n=new FileReader;n.onloadend=function(){var f=n.result;f=c?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=f:location=f,o=null},n.readAsDataURL(a)}else{var s=v.URL||v.webkitURL,u=s.createObjectURL(a);o?o.location=u:location.href=u,o=null,setTimeout(function(){s.revokeObjectURL(u)},4e4)}});v.saveAs=F.saveAs=F,X.exports=F})}(H)),H.exports}var De=xe();const Fe={class:"min-h-screen mb-16"},Ee={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},ye={class:"text-sm","aria-label":"Miga de pan"},Ce={class:"list-none p-0 inline-flex space-x-2"},_e={class:"flex items-center"},Se={class:"container mx-auto px-4 sm:px-6 lg:px-8"},Me={class:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 mb-6"},Be={class:"flex items-center gap-2 mb-2 sm:mb-0"},ke={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Le={class:"font-bold text-center mb-2"},Re={class:"grid grid-cols-7 text-center text-sm gap-y-1"},Ae=["title"],Te=ve({__name:"Calendar",setup(X){const m=z(new Date().getFullYear()),L=z([]);ee(()=>{const t=new Date().getFullYear();for(let e=t-10;e<=t+10;e++)L.value.push(e)});function D(t){function e(n){const s=n.getFullYear(),u=String(n.getMonth()+1).padStart(2,"0"),f=String(n.getDate()).padStart(2,"0");return`${s}-${u}-${f}`}function o(n){const s=n.getDay(),u=s===1?0:(8-s)%7;return new Date(n.getFullYear(),n.getMonth(),n.getDate()+u)}function l(n){const s=n%19,u=Math.floor(n/100),f=n%100,E=Math.floor(u/4),b=u%4,Y=Math.floor((u+8)/25),d=Math.floor((u-Y+1)/3),y=(19*s+u-E-d+15)%30,C=Math.floor(f/4),$=f%4,U=(32+2*b+2*C-y-$)%7,S=Math.floor((s+11*y+22*U)/451),V=y+U-7*S+114,I=Math.floor(V/31)-1,M=V%31+1;return new Date(n,I,M)}const i=l(t),c=[];return[["Año Nuevo",new Date(t,0,1)],["Día del Trabajo",new Date(t,4,1)],["Independencia de Colombia",new Date(t,6,20)],["Batalla de Boyacá",new Date(t,7,7)],["Inmaculada Concepción",new Date(t,11,8)],["Navidad",new Date(t,11,25)]].forEach(([n,s])=>{c.push({label:n,date:e(s)})}),[["Epifanía",new Date(t,0,6)],["San José",new Date(t,2,19)],["San Pedro y San Pablo",new Date(t,5,29)],["Asunción de la Virgen",new Date(t,7,15)],["Día de la Raza",new Date(t,9,12)],["Todos los Santos",new Date(t,10,1)],["Independencia de Cartagena",new Date(t,10,11)]].forEach(([n,s])=>{c.push({label:n,date:e(o(s))})}),c.push({label:"Jueves Santo",date:e(new Date(i.getTime()-3*864e5))}),c.push({label:"Viernes Santo",date:e(new Date(i.getTime()-2*864e5))}),c.push({label:"Ascensión del Señor",date:e(o(new Date(i.getTime()+43*864e5)))}),c.push({label:"Corpus Christi",date:e(o(new Date(i.getTime()+64*864e5)))}),c.push({label:"Sagrado Corazón",date:e(o(new Date(i.getTime()+71*864e5)))}),c.sort((n,s)=>n.date.localeCompare(s.date)),c}function R(t){const e=["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],[o,l,i]=t.split("-").map(Number);return e[new Date(o,l-1,i).getDay()]}const w=z(D(m.value));function v(){w.value=D(m.value)}const B=z([]);function F(){B.value=[];const t={};w.value.forEach(e=>t[e.date]=e.label);for(let e=0;e<12;e++){const o=new Date(m.value,e,1),i=new Date(m.value,e+1,0).getDate(),c=o.getDay(),n={nombre:o.toLocaleString("es-CO",{month:"long"}).toUpperCase(),dias:[]};for(let s=0;s<c;s++)n.dias.push({dia:"",tipo:"vacio"});for(let s=1;s<=i;s++){const u=new Date(m.value,e,s),f=u.toISOString().split("T")[0],E=u.getDay(),b=t[f];n.dias.push({dia:s,tipo:b?"festivo":E===0?"domingo":E===6?"sabado":"normal",titulo:b||""})}B.value.push(n)}}async function a(){const t=new fe.Workbook,e=t.addWorksheet("CALENDARIO"),o=["Do","Lu","Ma","Mi","Ju","Vi","Sa"],l=4;e.properties.defaultRowHeight=16;for(let d=1;d<=24;d++)e.getColumn(d).width=l;let i=2;const c=25,n=26,s=27;[{col:c,label:"Festivo"},{col:n,label:"Fecha"},{col:s,label:"Día"}].forEach(({col:d,label:y})=>{const C=e.getCell(1,d);C.value=y,C.font={bold:!0},C.alignment={horizontal:"center"},C.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE5E7EB"}},C.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}});const f={};w.value.forEach(d=>f[d.date]=d.label);let E=0,b=1;for(let d=0;d<12;d++){const y=new Date(m.value,d,1),$=new Date(m.value,d+1,0).getDate(),U=y.getDay(),S=d%3*8+1;d%3===0&&d>0&&(b=E+2);const V=y.toLocaleString("es-CO",{month:"long"}).toUpperCase(),I=e.getCell(b,S);I.value=`${V} ${m.value}`,I.font={bold:!0,size:14,color:{argb:"FF0F172A"}},e.mergeCells(b,S,b,S+6),o.forEach((A,k)=>{const _=e.getCell(b+1,S+k);_.value=A,_.font={bold:!0,color:{argb:"FF1E293B"}},_.alignment={horizontal:"center"},_.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE2E8F0"}},_.border={top:{style:"thin",color:{argb:"FFCBD5E1"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}}});let M=1;for(let A=0;M<=$;A++)for(let k=0;k<7;k++){const _=b+2+A,ne=S+k;if(E=Math.max(E,_),A===0&&k<U)continue;if(M>$)break;const q=new Date(m.value,d,M),W=q.toISOString().split("T")[0],J=f[W],x=e.getCell(_,ne);x.value=M,x.alignment={horizontal:"center",vertical:"middle"},x.border={top:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}},J?(x.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEE2E2"}},x.font={bold:!0,color:{argb:"FFB91C1C"}},x.note=J,e.getCell(i,c).value=J,e.getCell(i,n).value=W,e.getCell(i,s).value=R(W),[c,n,s].forEach(le=>{const K=e.getCell(i,le);K.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},K.alignment={vertical:"middle"}}),i++):q.getDay()===0?x.font={bold:!0,color:{argb:"FFDC2626"}}:q.getDay()===6?x.font={color:{argb:"FF2563EB"}}:x.font={color:{argb:"FF374151"}},M++}}e.getColumn(c).width=30,e.getColumn(n).width=14,e.getColumn(s).width=12;const Y=await t.xlsx.writeBuffer();De.saveAs(new Blob([Y]),`calendario_festivos_${m.value}.xlsx`)}return ge(m,()=>{v(),F()}),ee(()=>{v(),F()}),(t,e)=>{const o=be("router-link");return j(),T("div",Fe,[r("div",Ee,[r("nav",ye,[r("ol",Ce,[r("li",_e,[p(o,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:h(()=>e[2]||(e[2]=[r("i",{class:"inline-block w-4 h-4 mr-1 align-text-bottom"},null,-1),O(" Herramientas ")])),_:1,__:[2]})]),e[3]||(e[3]=r("li",null,[r("i",{class:"inline-block w-4 h-4 text-gray-400 align-text-bottom"})],-1)),e[4]||(e[4]=r("li",{class:"text-gray-700"},"Calendario",-1))])])]),r("div",Se,[e[10]||(e[10]=r("header",{class:"text-center mb-8"},[r("h1",{class:"text-4xl font-extrabold text-primary-700 mb-2"}," Calendario de Festivos ")],-1)),r("div",Me,[r("div",Be,[e[5]||(e[5]=r("label",{for:"anio",class:"text-surface-700 font-medium"},"Selecciona un año:",-1)),p(g(se),{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l),options:L.value,class:"w-32",onChange:e[1]||(e[1]=l=>{v(),F()})},null,8,["modelValue","options"])]),p(g(re),{onClick:a,severity:"warning",class:"flex items-center gap-2"},{default:h(()=>[p(g(pe),{class:"w-4 h-4"}),e[6]||(e[6]=O(" Exportar a Excel "))]),_:1,__:[6]})]),p(g(ie),{value:"calendar"},{default:h(()=>[p(g(ce),null,{default:h(()=>[p(g(Q),{value:"calendar"},{default:h(()=>e[7]||(e[7]=[O("Calendario")])),_:1,__:[7]}),p(g(Q),{value:"festivos"},{default:h(()=>e[8]||(e[8]=[O("Festivos")])),_:1,__:[8]})]),_:1}),p(g(de),null,{default:h(()=>[p(g(Z),{value:"calendar"},{default:h(()=>[r("div",ke,[(j(!0),T(te,null,oe(B.value,l=>(j(),T("div",{key:l.nombre,class:"rounded border p-3 shadow-sm bg-surface-card"},[r("div",Le,P(l.nombre),1),e[9]||(e[9]=r("div",{class:"grid grid-cols-7 text-center text-xs font-semibold text-surface-600 mb-1"},[r("div",null,"Do"),r("div",null,"Lu"),r("div",null,"Ma"),r("div",null,"Mi"),r("div",null,"Ju"),r("div",null,"Vi"),r("div",null,"Sa")],-1)),r("div",Re,[(j(!0),T(te,null,oe(l.dias,(i,c)=>(j(),T("div",{key:c,class:he(["rounded px-1 py-0.5",{"bg-red-100 text-red-700 font-semibold cursor-help":i.tipo==="festivo","text-red-500 font-semibold":i.tipo==="domingo","text-blue-500":i.tipo==="sabado","text-surface-700":i.tipo==="normal"}]),title:i.titulo},P(i.dia),11,Ae))),128))])]))),128))])]),_:1}),p(g(Z),{value:"festivos"},{default:h(()=>[p(g(ue),{value:w.value,class:"p-datatable-sm",stripedRows:"",showGridlines:"",tableStyle:"min-width: 50rem"},{default:h(()=>[p(g(G),{field:"label",header:"Festivo"}),p(g(G),{field:"date",header:"Fecha"}),p(g(G),{header:"Día"},{body:h(({data:l})=>[O(P(R(l.date)),1)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})])])}}}),Ne=me(Te,[["__scopeId","data-v-bb9328ef"]]);export{Ne as default};
