import{g as re,i as ie,f as ce,a as de,t as ue,v as P,w as fe,x as Q,y as pe,z as N,A as me}from"./primevue-CTM77RMy.js";import{_ as ve}from"./BreadcrumbNav.vue_vue_type_script_setup_true_lang-CwPMA7cQ.js";import{e as ge}from"./exceljs.min-BO0RjN_l.js";import{c as j}from"./_commonjsHelpers-D6-XlEtG.js";import{g as Z,C as be}from"./colombiaBusinessDays-9Qcxgqlo.js";import{e as he,f as we,_ as ye}from"./index-DrBQnuTu.js";import{L as xe}from"./list-8jFALFCd.js";import{P as Fe,r as T,o as ee,w as Ee,c as B,x as n,e as m,B as p,R as l,d as L,A as U,F as q,i as Y,t as V,p as _e}from"./vue-vendor-ByoO1CXK.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";var z={exports:{}},Ce=z.exports,te;function De(){return te||(te=1,function(G,c){(function(R,F){F()})(Ce,function(){function R(a,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function F(a,o,e){var t=new XMLHttpRequest;t.open("GET",a),t.responseType="blob",t.onload=function(){y(t.response,o,e)},t.onerror=function(){console.error("could not download file")},t.send()}function k(a){var o=new XMLHttpRequest;o.open("HEAD",a,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function g(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(o)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof j=="object"&&j.global===j?j:void 0,_=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),y=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!_?function(a,o,e){var t=d.URL||d.webkitURL,s=document.createElement("a");o=o||a.name||"download",s.download=o,s.rel="noopener",typeof a=="string"?(s.href=a,s.origin===location.origin?g(s):k(s.href)?F(a,o,e):g(s,s.target="_blank")):(s.href=t.createObjectURL(a),setTimeout(function(){t.revokeObjectURL(s.href)},4e4),setTimeout(function(){g(s)},0))}:"msSaveOrOpenBlob"in navigator?function(a,o,e){if(o=o||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(R(a,e),o);else if(k(a))F(a,o,e);else{var t=document.createElement("a");t.href=a,t.target="_blank",setTimeout(function(){g(t)})}}:function(a,o,e,t){if(t=t||open("","_blank"),t&&(t.document.title=t.document.body.innerText="downloading..."),typeof a=="string")return F(a,o,e);var s=a.type==="application/octet-stream",u=/constructor/i.test(d.HTMLElement)||d.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||s&&u||_)&&typeof FileReader<"u"){var f=new FileReader;f.onloadend=function(){var v=f.result;v=b?v:v.replace(/^data:[^;]*;/,"data:attachment/file;"),t?t.location.href=v:location=v,t=null},f.readAsDataURL(a)}else{var i=d.URL||d.webkitURL,E=i.createObjectURL(a);t?t.location=E:location.href=E,t=null,setTimeout(function(){i.revokeObjectURL(E)},4e4)}});d.saveAs=y.saveAs=y,G.exports=y})}(z)),z.exports}var Se=De();const Be={class:"min-h-screen mb-16"},Le={class:"container mx-auto px-4 sm:px-6 lg:px-8"},Re={class:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 mb-6"},ke={class:"flex items-center gap-2 mb-2 sm:mb-0"},Me={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Ae={class:"font-bold text-center mb-2"},$e={class:"grid grid-cols-7 text-center text-xs font-semibold text-surface-600 mb-1"},Oe={class:"grid grid-cols-7 text-center text-sm gap-y-1"},je=["title"],Te=Fe({__name:"Calendar",setup(G){const c=T(new Date().getFullYear()),R=T([]),F=["Do","Lu","Ma","Mi","Ju","Vi","Sa"];ee(()=>{const o=new Date().getFullYear();for(let e=o-10;e<=o+10;e++)R.value.push(e)});function k(o){const e=["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],[t,s,u]=o.split("-").map(Number);return e[new Date(t,s-1,u).getDay()]}const g=T(Z(c.value));function d(){g.value=Z(c.value)}const _=T([]);function y(){_.value=[];const o={};g.value.forEach(e=>o[e.date]=e.label);for(let e=0;e<12;e++){const t=new Date(c.value,e,1),u=new Date(c.value,e+1,0).getDate(),b=t.getDay(),f={nombre:t.toLocaleString("es-CO",{month:"long"}).toUpperCase(),dias:[]};for(let i=0;i<b;i++)f.dias.push({dia:"",tipo:"vacio"});for(let i=1;i<=u;i++){const E=new Date(c.value,e,i),v=E.toISOString().split("T")[0],C=E.getDay(),h=o[v];f.dias.push({dia:i,tipo:h?"festivo":C===0?"domingo":C===6?"sabado":"normal",titulo:h||""})}_.value.push(f)}}async function a(){const o=new ge.Workbook,e=o.addWorksheet("CALENDARIO"),t=["Do","Lu","Ma","Mi","Ju","Vi","Sa"],s=4;e.properties.defaultRowHeight=16;for(let r=1;r<=24;r++)e.getColumn(r).width=s;let u=2;const b=25,f=26,i=27;[{col:b,label:"Festivo"},{col:f,label:"Fecha"},{col:i,label:"Día"}].forEach(({col:r,label:O})=>{const D=e.getCell(1,r);D.value=O,D.font={bold:!0},D.alignment={horizontal:"center"},D.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE5E7EB"}},D.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}});const v={};g.value.forEach(r=>v[r.date]=r.label);let C=0,h=1;for(let r=0;r<12;r++){const O=new Date(c.value,r,1),J=new Date(c.value,r+1,0).getDate(),ae=O.getDay(),M=r%3*8+1;r%3===0&&r>0&&(h=C+2);const se=O.toLocaleString("es-CO",{month:"long"}).toUpperCase(),X=e.getCell(h,M);X.value=`${se} ${c.value}`,X.font={bold:!0,size:14,color:{argb:"FF0F172A"}},e.mergeCells(h,M,h,M+6),t.forEach(($,S)=>{const x=e.getCell(h+1,M+S);x.value=$,x.font={bold:!0,color:{argb:"FF1E293B"}},x.alignment={horizontal:"center"},x.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE2E8F0"}},x.border={top:{style:"thin",color:{argb:"FFCBD5E1"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}}});let A=1;for(let $=0;A<=J;$++)for(let S=0;S<7;S++){const x=h+2+$,ne=M+S;if(C=Math.max(C,x),$===0&&S<ae)continue;if(A>J)break;const H=new Date(c.value,r,A),W=H.toISOString().split("T")[0],I=v[W],w=e.getCell(x,ne);w.value=A,w.alignment={horizontal:"center",vertical:"middle"},w.border={top:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}},I?(w.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEE2E2"}},w.font={bold:!0,color:{argb:"FFB91C1C"}},w.note=I,e.getCell(u,b).value=I,e.getCell(u,f).value=W,e.getCell(u,i).value=k(W),[b,f,i].forEach(le=>{const K=e.getCell(u,le);K.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},K.alignment={vertical:"middle"}}),u++):H.getDay()===0?w.font={bold:!0,color:{argb:"FFDC2626"}}:H.getDay()===6?w.font={color:{argb:"FF2563EB"}}:w.font={color:{argb:"FF374151"}},A++}}e.getColumn(b).width=30,e.getColumn(f).width=14,e.getColumn(i).width=12;const oe=await o.xlsx.writeBuffer();Se.saveAs(new Blob([oe]),`calendario_festivos_${c.value}.xlsx`)}return Ee(c,()=>{d(),y()}),ee(()=>{d(),y()}),(o,e)=>(L(),B("div",Be,[n(ve),m("div",Le,[e[6]||(e[6]=m("header",{class:"text-center mb-8"},[m("h1",{class:"text-4xl font-extrabold text-primary-700 mb-2"}," Calendario colombiano ")],-1)),m("div",Re,[m("div",ke,[e[2]||(e[2]=m("label",{for:"anio",class:"text-surface-700 font-medium"},"Año:",-1)),n(l(ce),null,{default:p(()=>[n(l(re),null,{default:p(()=>[n(l(be),{class:"w-4 h-4"})]),_:1}),n(l(ie),{id:"anio",name:"anio",modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),options:R.value,class:"w-32",onChange:e[1]||(e[1]=t=>{d(),y()})},null,8,["modelValue","options"])]),_:1})]),n(l(de),{onClick:a,severity:"warning",class:"flex items-center gap-2"},{default:p(()=>[n(l(he),{class:"w-4 h-4"}),e[3]||(e[3]=U(" Exportar a Excel "))]),_:1,__:[3]})]),n(l(me),{value:"calendar"},{default:p(()=>[n(l(ue),null,{default:p(()=>[n(l(P),{value:"calendar",class:"flex items-center gap-2"},{default:p(()=>[n(l(we),{class:"w-4 h-4"}),e[4]||(e[4]=U(" Calendario "))]),_:1,__:[4]}),n(l(P),{value:"festivos",class:"flex items-center gap-2"},{default:p(()=>[n(l(xe),{class:"w-4 h-4"}),e[5]||(e[5]=U(" Festivos "))]),_:1,__:[5]})]),_:1}),n(l(fe),null,{default:p(()=>[n(l(Q),{value:"calendar"},{default:p(()=>[m("div",Me,[(L(!0),B(q,null,Y(_.value,t=>(L(),B("div",{key:t.nombre,class:"rounded border p-3 shadow-sm bg-surface-card"},[m("div",Ae,V(t.nombre),1),m("div",$e,[(L(),B(q,null,Y(F,s=>m("div",{key:s},V(s),1)),64))]),m("div",Oe,[(L(!0),B(q,null,Y(t.dias,(s,u)=>(L(),B("div",{key:u,class:_e(["rounded px-1 py-0.5",{"bg-red-100 text-red-700 font-semibold cursor-help":s.tipo==="festivo","text-red-500 font-semibold":s.tipo==="domingo","text-blue-500":s.tipo==="sabado","text-surface-700":s.tipo==="normal"}]),title:s.titulo},V(s.dia),11,je))),128))])]))),128))])]),_:1}),n(l(Q),{value:"festivos"},{default:p(()=>[n(l(pe),{value:g.value,class:"p-datatable-sm",stripedRows:"",showGridlines:"",tableStyle:"min-width: 50rem"},{default:p(()=>[n(l(N),{field:"label",header:"Festivo"}),n(l(N),{field:"date",header:"Fecha"}),n(l(N),{header:"Día"},{body:p(({data:t})=>[U(V(k(t.date)),1)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})])]))}}),Ge=ye(Te,[["__scopeId","data-v-7a019560"]]);export{Ge as default};
