import{n as re,a as ie,o as ce,p as P,q as de,r as Q,t as ue,v as I,w as fe}from"./primevue-Bq9JCDGo.js";import{e as pe}from"./exceljs.min-BO0RjN_l.js";import{c as T}from"./_commonjsHelpers-D6-XlEtG.js";import{g as Z}from"./colombiaBusinessDays-D5vJ0wC3.js";import{b as me,_ as ve}from"./index-CM_oPd0Y.js";import{P as be,r as U,o as ee,w as ge,c as k,e as s,x as c,B as v,A as j,f as he,R as f,F as N,i as Y,t as V,d as B,p as we}from"./vue-vendor-DSKsDytq.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";var H={exports:{}},xe=H.exports,te;function ye(){return te||(te=1,function(G,d){(function(M,F){F()})(xe,function(){function M(a,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function F(a,t,e){var o=new XMLHttpRequest;o.open("GET",a),o.responseType="blob",o.onload=function(){x(o.response,t,e)},o.onerror=function(){console.error("could not download file")},o.send()}function R(a){var t=new XMLHttpRequest;t.open("HEAD",a,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function g(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(t)}}var u=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof T=="object"&&T.global===T?T:void 0,_=u.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),x=u.saveAs||(typeof window!="object"||window!==u?function(){}:"download"in HTMLAnchorElement.prototype&&!_?function(a,t,e){var o=u.URL||u.webkitURL,n=document.createElement("a");t=t||a.name||"download",n.download=t,n.rel="noopener",typeof a=="string"?(n.href=a,n.origin===location.origin?g(n):R(n.href)?F(a,t,e):g(n,n.target="_blank")):(n.href=o.createObjectURL(a),setTimeout(function(){o.revokeObjectURL(n.href)},4e4),setTimeout(function(){g(n)},0))}:"msSaveOrOpenBlob"in navigator?function(a,t,e){if(t=t||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(M(a,e),t);else if(R(a))F(a,t,e);else{var o=document.createElement("a");o.href=a,o.target="_blank",setTimeout(function(){g(o)})}}:function(a,t,e,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof a=="string")return F(a,t,e);var n=a.type==="application/octet-stream",l=/constructor/i.test(u.HTMLElement)||u.safari,m=/CriOS\/[\d]+/.test(navigator.userAgent);if((m||n&&l||_)&&typeof FileReader<"u"){var p=new FileReader;p.onloadend=function(){var b=p.result;b=m?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=b:location=b,o=null},p.readAsDataURL(a)}else{var i=u.URL||u.webkitURL,E=i.createObjectURL(a);o?o.location=E:location.href=E,o=null,setTimeout(function(){i.revokeObjectURL(E)},4e4)}});u.saveAs=x.saveAs=x,G.exports=x})}(H)),H.exports}var Fe=ye();const Ee={class:"min-h-screen mb-16"},_e={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},Ce={class:"text-sm","aria-label":"Miga de pan"},De={class:"list-none p-0 inline-flex space-x-2"},Se={class:"flex items-center"},ke={class:"container mx-auto px-4 sm:px-6 lg:px-8"},Be={class:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 mb-6"},Me={class:"flex items-center gap-2 mb-2 sm:mb-0"},Re={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Le={class:"font-bold text-center mb-2"},Ae={class:"grid grid-cols-7 text-center text-xs font-semibold text-surface-600 mb-1"},Oe={class:"grid grid-cols-7 text-center text-sm gap-y-1"},je=["title"],$e=be({__name:"Calendar",setup(G){const d=U(new Date().getFullYear()),M=U([]),F=["Do","Lu","Ma","Mi","Ju","Vi","Sa"];ee(()=>{const t=new Date().getFullYear();for(let e=t-10;e<=t+10;e++)M.value.push(e)});function R(t){const e=["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],[o,n,l]=t.split("-").map(Number);return e[new Date(o,n-1,l).getDay()]}const g=U(Z(d.value));function u(){g.value=Z(d.value)}const _=U([]);function x(){_.value=[];const t={};g.value.forEach(e=>t[e.date]=e.label);for(let e=0;e<12;e++){const o=new Date(d.value,e,1),l=new Date(d.value,e+1,0).getDate(),m=o.getDay(),p={nombre:o.toLocaleString("es-CO",{month:"long"}).toUpperCase(),dias:[]};for(let i=0;i<m;i++)p.dias.push({dia:"",tipo:"vacio"});for(let i=1;i<=l;i++){const E=new Date(d.value,e,i),b=E.toISOString().split("T")[0],C=E.getDay(),h=t[b];p.dias.push({dia:i,tipo:h?"festivo":C===0?"domingo":C===6?"sabado":"normal",titulo:h||""})}_.value.push(p)}}async function a(){const t=new pe.Workbook,e=t.addWorksheet("CALENDARIO"),o=["Do","Lu","Ma","Mi","Ju","Vi","Sa"],n=4;e.properties.defaultRowHeight=16;for(let r=1;r<=24;r++)e.getColumn(r).width=n;let l=2;const m=25,p=26,i=27;[{col:m,label:"Festivo"},{col:p,label:"Fecha"},{col:i,label:"Día"}].forEach(({col:r,label:$})=>{const D=e.getCell(1,r);D.value=$,D.font={bold:!0},D.alignment={horizontal:"center"},D.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE5E7EB"}},D.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}});const b={};g.value.forEach(r=>b[r.date]=r.label);let C=0,h=1;for(let r=0;r<12;r++){const $=new Date(d.value,r,1),J=new Date(d.value,r+1,0).getDate(),ae=$.getDay(),L=r%3*8+1;r%3===0&&r>0&&(h=C+2);const ne=$.toLocaleString("es-CO",{month:"long"}).toUpperCase(),X=e.getCell(h,L);X.value=`${ne} ${d.value}`,X.font={bold:!0,size:14,color:{argb:"FF0F172A"}},e.mergeCells(h,L,h,L+6),o.forEach((O,S)=>{const y=e.getCell(h+1,L+S);y.value=O,y.font={bold:!0,color:{argb:"FF1E293B"}},y.alignment={horizontal:"center"},y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE2E8F0"}},y.border={top:{style:"thin",color:{argb:"FFCBD5E1"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}}});let A=1;for(let O=0;A<=J;O++)for(let S=0;S<7;S++){const y=h+2+O,le=L+S;if(C=Math.max(C,y),O===0&&S<ae)continue;if(A>J)break;const W=new Date(d.value,r,A),q=W.toISOString().split("T")[0],z=b[q],w=e.getCell(y,le);w.value=A,w.alignment={horizontal:"center",vertical:"middle"},w.border={top:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}},z?(w.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEE2E2"}},w.font={bold:!0,color:{argb:"FFB91C1C"}},w.note=z,e.getCell(l,m).value=z,e.getCell(l,p).value=q,e.getCell(l,i).value=R(q),[m,p,i].forEach(se=>{const K=e.getCell(l,se);K.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},K.alignment={vertical:"middle"}}),l++):W.getDay()===0?w.font={bold:!0,color:{argb:"FFDC2626"}}:W.getDay()===6?w.font={color:{argb:"FF2563EB"}}:w.font={color:{argb:"FF374151"}},A++}}e.getColumn(m).width=30,e.getColumn(p).width=14,e.getColumn(i).width=12;const oe=await t.xlsx.writeBuffer();Fe.saveAs(new Blob([oe]),`calendario_festivos_${d.value}.xlsx`)}return ge(d,()=>{u(),x()}),ee(()=>{u(),x()}),(t,e)=>{const o=he("router-link");return B(),k("div",Ee,[s("div",_e,[s("nav",Ce,[s("ol",De,[s("li",Se,[c(o,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:v(()=>e[2]||(e[2]=[s("i",{class:"inline-block w-4 h-4 mr-1 align-text-bottom"},null,-1),j(" Herramientas ")])),_:1,__:[2]})]),e[3]||(e[3]=s("li",null,[s("i",{class:"inline-block w-4 h-4 text-gray-400 align-text-bottom"})],-1)),e[4]||(e[4]=s("li",{class:"text-gray-700"},"Calendario",-1))])])]),s("div",ke,[e[9]||(e[9]=s("header",{class:"text-center mb-8"},[s("h1",{class:"text-4xl font-extrabold text-primary-700 mb-2"}," Calendario colombiano ")],-1)),s("div",Be,[s("div",Me,[e[5]||(e[5]=s("label",{for:"anio",class:"text-surface-700 font-medium"},"Selecciona un año:",-1)),c(f(re),{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=n=>d.value=n),options:M.value,class:"w-32",onChange:e[1]||(e[1]=n=>{u(),x()})},null,8,["modelValue","options"])]),c(f(ie),{onClick:a,severity:"warning",class:"flex items-center gap-2"},{default:v(()=>[c(f(me),{class:"w-4 h-4"}),e[6]||(e[6]=j(" Exportar a Excel "))]),_:1,__:[6]})]),c(f(fe),{value:"calendar"},{default:v(()=>[c(f(ce),null,{default:v(()=>[c(f(P),{value:"calendar"},{default:v(()=>e[7]||(e[7]=[j("Calendario")])),_:1,__:[7]}),c(f(P),{value:"festivos"},{default:v(()=>e[8]||(e[8]=[j("Festivos")])),_:1,__:[8]})]),_:1}),c(f(de),null,{default:v(()=>[c(f(Q),{value:"calendar"},{default:v(()=>[s("div",Re,[(B(!0),k(N,null,Y(_.value,n=>(B(),k("div",{key:n.nombre,class:"rounded border p-3 shadow-sm bg-surface-card"},[s("div",Le,V(n.nombre),1),s("div",Ae,[(B(),k(N,null,Y(F,l=>s("div",{key:l},V(l),1)),64))]),s("div",Oe,[(B(!0),k(N,null,Y(n.dias,(l,m)=>(B(),k("div",{key:m,class:we(["rounded px-1 py-0.5",{"bg-red-100 text-red-700 font-semibold cursor-help":l.tipo==="festivo","text-red-500 font-semibold":l.tipo==="domingo","text-blue-500":l.tipo==="sabado","text-surface-700":l.tipo==="normal"}]),title:l.titulo},V(l.dia),11,je))),128))])]))),128))])]),_:1}),c(f(Q),{value:"festivos"},{default:v(()=>[c(f(ue),{value:g.value,class:"p-datatable-sm",stripedRows:"",showGridlines:"",tableStyle:"min-width: 50rem"},{default:v(()=>[c(f(I),{field:"label",header:"Festivo"}),c(f(I),{field:"date",header:"Fecha"}),c(f(I),{header:"Día"},{body:v(({data:n})=>[j(V(R(n.date)),1)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})])])}}}),Ie=ve($e,[["__scopeId","data-v-ef67e5f4"]]);export{Ie as default};
