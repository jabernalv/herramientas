import{n as re,o as ie,p as ce,a as de,q as ue,r as P,t as fe,v as Q,w as pe,x as I,y as me}from"./primevue-BtpsDkMC.js";import{e as ve}from"./exceljs.min-BO0RjN_l.js";import{c as T}from"./_commonjsHelpers-D6-XlEtG.js";import{g as Z,C as ge}from"./colombiaBusinessDays-CWnI6CbE.js";import{b as be,C as he,_ as we}from"./index-Cmp_5KCk.js";import{L as xe}from"./list-CxXkj3XC.js";import{P as ye,r as U,o as ee,w as Fe,c as k,e as r,x as n,B as p,A as $,f as Ee,R as i,F as N,i as Y,t as V,d as B,p as _e}from"./vue-vendor-DSKsDytq.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";var H={exports:{}},Ce=H.exports,te;function De(){return te||(te=1,function(G,u){(function(L,F){F()})(Ce,function(){function L(a,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function F(a,t,e){var o=new XMLHttpRequest;o.open("GET",a),o.responseType="blob",o.onload=function(){x(o.response,t,e)},o.onerror=function(){console.error("could not download file")},o.send()}function M(a){var t=new XMLHttpRequest;t.open("HEAD",a,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function b(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(t)}}var f=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof T=="object"&&T.global===T?T:void 0,_=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),x=f.saveAs||(typeof window!="object"||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!_?function(a,t,e){var o=f.URL||f.webkitURL,s=document.createElement("a");t=t||a.name||"download",s.download=t,s.rel="noopener",typeof a=="string"?(s.href=a,s.origin===location.origin?b(s):M(s.href)?F(a,t,e):b(s,s.target="_blank")):(s.href=o.createObjectURL(a),setTimeout(function(){o.revokeObjectURL(s.href)},4e4),setTimeout(function(){b(s)},0))}:"msSaveOrOpenBlob"in navigator?function(a,t,e){if(t=t||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(L(a,e),t);else if(M(a))F(a,t,e);else{var o=document.createElement("a");o.href=a,o.target="_blank",setTimeout(function(){b(o)})}}:function(a,t,e,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof a=="string")return F(a,t,e);var s=a.type==="application/octet-stream",l=/constructor/i.test(f.HTMLElement)||f.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||s&&l||_)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var g=m.result;g=v?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=g:location=g,o=null},m.readAsDataURL(a)}else{var d=f.URL||f.webkitURL,E=d.createObjectURL(a);o?o.location=E:location.href=E,o=null,setTimeout(function(){d.revokeObjectURL(E)},4e4)}});f.saveAs=x.saveAs=x,G.exports=x})}(H)),H.exports}var Se=De();const ke={class:"min-h-screen mb-16"},Be={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},Le={class:"text-sm","aria-label":"Miga de pan"},Me={class:"list-none p-0 inline-flex space-x-2"},Re={class:"flex items-center"},Ae={class:"container mx-auto px-4 sm:px-6 lg:px-8"},Oe={class:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 mb-6"},$e={class:"flex items-center gap-2 mb-2 sm:mb-0"},je={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Te={class:"font-bold text-center mb-2"},Ue={class:"grid grid-cols-7 text-center text-xs font-semibold text-surface-600 mb-1"},Ve={class:"grid grid-cols-7 text-center text-sm gap-y-1"},He=["title"],We=ye({__name:"Calendar",setup(G){const u=U(new Date().getFullYear()),L=U([]),F=["Do","Lu","Ma","Mi","Ju","Vi","Sa"];ee(()=>{const t=new Date().getFullYear();for(let e=t-10;e<=t+10;e++)L.value.push(e)});function M(t){const e=["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],[o,s,l]=t.split("-").map(Number);return e[new Date(o,s-1,l).getDay()]}const b=U(Z(u.value));function f(){b.value=Z(u.value)}const _=U([]);function x(){_.value=[];const t={};b.value.forEach(e=>t[e.date]=e.label);for(let e=0;e<12;e++){const o=new Date(u.value,e,1),l=new Date(u.value,e+1,0).getDate(),v=o.getDay(),m={nombre:o.toLocaleString("es-CO",{month:"long"}).toUpperCase(),dias:[]};for(let d=0;d<v;d++)m.dias.push({dia:"",tipo:"vacio"});for(let d=1;d<=l;d++){const E=new Date(u.value,e,d),g=E.toISOString().split("T")[0],C=E.getDay(),h=t[g];m.dias.push({dia:d,tipo:h?"festivo":C===0?"domingo":C===6?"sabado":"normal",titulo:h||""})}_.value.push(m)}}async function a(){const t=new ve.Workbook,e=t.addWorksheet("CALENDARIO"),o=["Do","Lu","Ma","Mi","Ju","Vi","Sa"],s=4;e.properties.defaultRowHeight=16;for(let c=1;c<=24;c++)e.getColumn(c).width=s;let l=2;const v=25,m=26,d=27;[{col:v,label:"Festivo"},{col:m,label:"Fecha"},{col:d,label:"Día"}].forEach(({col:c,label:j})=>{const D=e.getCell(1,c);D.value=j,D.font={bold:!0},D.alignment={horizontal:"center"},D.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE5E7EB"}},D.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}});const g={};b.value.forEach(c=>g[c.date]=c.label);let C=0,h=1;for(let c=0;c<12;c++){const j=new Date(u.value,c,1),J=new Date(u.value,c+1,0).getDate(),ae=j.getDay(),R=c%3*8+1;c%3===0&&c>0&&(h=C+2);const se=j.toLocaleString("es-CO",{month:"long"}).toUpperCase(),X=e.getCell(h,R);X.value=`${se} ${u.value}`,X.font={bold:!0,size:14,color:{argb:"FF0F172A"}},e.mergeCells(h,R,h,R+6),o.forEach((O,S)=>{const y=e.getCell(h+1,R+S);y.value=O,y.font={bold:!0,color:{argb:"FF1E293B"}},y.alignment={horizontal:"center"},y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE2E8F0"}},y.border={top:{style:"thin",color:{argb:"FFCBD5E1"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}}});let A=1;for(let O=0;A<=J;O++)for(let S=0;S<7;S++){const y=h+2+O,le=R+S;if(C=Math.max(C,y),O===0&&S<ae)continue;if(A>J)break;const W=new Date(u.value,c,A),q=W.toISOString().split("T")[0],z=g[q],w=e.getCell(y,le);w.value=A,w.alignment={horizontal:"center",vertical:"middle"},w.border={top:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}},z?(w.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEE2E2"}},w.font={bold:!0,color:{argb:"FFB91C1C"}},w.note=z,e.getCell(l,v).value=z,e.getCell(l,m).value=q,e.getCell(l,d).value=M(q),[v,m,d].forEach(ne=>{const K=e.getCell(l,ne);K.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},K.alignment={vertical:"middle"}}),l++):W.getDay()===0?w.font={bold:!0,color:{argb:"FFDC2626"}}:W.getDay()===6?w.font={color:{argb:"FF2563EB"}}:w.font={color:{argb:"FF374151"}},A++}}e.getColumn(v).width=30,e.getColumn(m).width=14,e.getColumn(d).width=12;const oe=await t.xlsx.writeBuffer();Se.saveAs(new Blob([oe]),`calendario_festivos_${u.value}.xlsx`)}return Fe(u,()=>{f(),x()}),ee(()=>{f(),x()}),(t,e)=>{const o=Ee("router-link");return B(),k("div",ke,[r("div",Be,[r("nav",Le,[r("ol",Me,[r("li",Re,[n(o,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:p(()=>e[2]||(e[2]=[r("i",{class:"inline-block w-4 h-4 mr-1 align-text-bottom"},null,-1),$(" Herramientas ")])),_:1,__:[2]})]),e[3]||(e[3]=r("li",null,[r("i",{class:"inline-block w-4 h-4 text-gray-400 align-text-bottom"})],-1)),e[4]||(e[4]=r("li",{class:"text-gray-700"},"Calendario",-1))])])]),r("div",Ae,[e[9]||(e[9]=r("header",{class:"text-center mb-8"},[r("h1",{class:"text-4xl font-extrabold text-primary-700 mb-2"}," Calendario colombiano ")],-1)),r("div",Oe,[r("div",$e,[e[5]||(e[5]=r("label",{for:"anio",class:"text-surface-700 font-medium"},"Año:",-1)),n(i(ce),null,{default:p(()=>[n(i(re),null,{default:p(()=>[n(i(ge),{class:"w-4 h-4"})]),_:1}),n(i(ie),{id:"anio",name:"anio",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),options:L.value,class:"w-32",onChange:e[1]||(e[1]=s=>{f(),x()})},null,8,["modelValue","options"])]),_:1})]),n(i(de),{onClick:a,severity:"warning",class:"flex items-center gap-2"},{default:p(()=>[n(i(be),{class:"w-4 h-4"}),e[6]||(e[6]=$(" Exportar a Excel "))]),_:1,__:[6]})]),n(i(me),{value:"calendar"},{default:p(()=>[n(i(ue),null,{default:p(()=>[n(i(P),{value:"calendar",class:"flex items-center gap-2"},{default:p(()=>[n(i(he),{class:"w-4 h-4"}),e[7]||(e[7]=$(" Calendario "))]),_:1,__:[7]}),n(i(P),{value:"festivos",class:"flex items-center gap-2"},{default:p(()=>[n(i(xe),{class:"w-4 h-4"}),e[8]||(e[8]=$(" Festivos "))]),_:1,__:[8]})]),_:1}),n(i(fe),null,{default:p(()=>[n(i(Q),{value:"calendar"},{default:p(()=>[r("div",je,[(B(!0),k(N,null,Y(_.value,s=>(B(),k("div",{key:s.nombre,class:"rounded border p-3 shadow-sm bg-surface-card"},[r("div",Te,V(s.nombre),1),r("div",Ue,[(B(),k(N,null,Y(F,l=>r("div",{key:l},V(l),1)),64))]),r("div",Ve,[(B(!0),k(N,null,Y(s.dias,(l,v)=>(B(),k("div",{key:v,class:_e(["rounded px-1 py-0.5",{"bg-red-100 text-red-700 font-semibold cursor-help":l.tipo==="festivo","text-red-500 font-semibold":l.tipo==="domingo","text-blue-500":l.tipo==="sabado","text-surface-700":l.tipo==="normal"}]),title:l.titulo},V(l.dia),11,He))),128))])]))),128))])]),_:1}),n(i(Q),{value:"festivos"},{default:p(()=>[n(i(pe),{value:b.value,class:"p-datatable-sm",stripedRows:"",showGridlines:"",tableStyle:"min-width: 50rem"},{default:p(()=>[n(i(I),{field:"label",header:"Festivo"}),n(i(I),{field:"date",header:"Fecha"}),n(i(I),{header:"Día"},{body:p(({data:s})=>[$(V(M(s.date)),1)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})])])}}}),Ke=we(We,[["__scopeId","data-v-c6295523"]]);export{Ke as default};
