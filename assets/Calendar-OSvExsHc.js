import{l as se,a as re,m as ie,n as J,o as ce,p as X,q as de,r as z,t as ue}from"./primevue-Cz0MYcUz.js";import{e as fe}from"./exceljs.min-BO0RjN_l.js";import{c as $}from"./_commonjsHelpers-D6-XlEtG.js";import{g as K}from"./colombiaBusinessDays-C02I8_n1.js";import{b as pe,_ as me}from"./index-DeQjBybw.js";import{P as ve,r as T,o as P,w as be,c as L,e as l,x as i,B as m,A,f as ge,R as u,F as Q,i as Z,t as I,d as j,p as he}from"./vue-vendor-DSKsDytq.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";var U={exports:{}},we=U.exports,ee;function xe(){return ee||(ee=1,function(N,c){(function(B,h){h()})(we,function(){function B(t,e){return typeof e>"u"?e={autoBom:!1}:typeof e!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t}function h(t,e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){_(o.response,e,n)},o.onerror=function(){console.error("could not download file")},o.send()}function F(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return 200<=e.status&&299>=e.status}function w(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof $=="object"&&$.global===$?$:void 0,E=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),_=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!E?function(t,e,n){var o=d.URL||d.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin===location.origin?w(a):F(a.href)?h(t,e,n):w(a,a.target="_blank")):(a.href=o.createObjectURL(t),setTimeout(function(){o.revokeObjectURL(a.href)},4e4),setTimeout(function(){w(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t!="string")navigator.msSaveOrOpenBlob(B(t,n),e);else if(F(t))h(t,e,n);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout(function(){w(o)})}}:function(t,e,n,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof t=="string")return h(t,e,n);var a=t.type==="application/octet-stream",v=/constructor/i.test(d.HTMLElement)||d.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||a&&v||E)&&typeof FileReader<"u"){var r=new FileReader;r.onloadend=function(){var f=r.result;f=p?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=f:location=f,o=null},r.readAsDataURL(t)}else{var C=d.URL||d.webkitURL,x=C.createObjectURL(t);o?o.location=x:location.href=x,o=null,setTimeout(function(){C.revokeObjectURL(x)},4e4)}});d.saveAs=_.saveAs=_,N.exports=_})}(U)),U.exports}var ye=xe();const Fe={class:"min-h-screen mb-16"},Ee={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},_e={class:"text-sm","aria-label":"Miga de pan"},Ce={class:"list-none p-0 inline-flex space-x-2"},De={class:"flex items-center"},Se={class:"container mx-auto px-4 sm:px-6 lg:px-8"},Be={class:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 mb-6"},ke={class:"flex items-center gap-2 mb-2 sm:mb-0"},Me={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Re={class:"font-bold text-center mb-2"},Le={class:"grid grid-cols-7 text-center text-sm gap-y-1"},Ae=["title"],je=ve({__name:"Calendar",setup(N){const c=T(new Date().getFullYear()),B=T([]);P(()=>{const t=new Date().getFullYear();for(let e=t-10;e<=t+10;e++)B.value.push(e)});function h(t){const e=["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],[n,o,a]=t.split("-").map(Number);return e[new Date(n,o-1,a).getDay()]}const F=T(K(c.value));function w(){F.value=K(c.value)}const d=T([]);function E(){d.value=[];const t={};F.value.forEach(e=>t[e.date]=e.label);for(let e=0;e<12;e++){const n=new Date(c.value,e,1),a=new Date(c.value,e+1,0).getDate(),v=n.getDay(),p={nombre:n.toLocaleString("es-CO",{month:"long"}).toUpperCase(),dias:[]};for(let r=0;r<v;r++)p.dias.push({dia:"",tipo:"vacio"});for(let r=1;r<=a;r++){const C=new Date(c.value,e,r),x=C.toISOString().split("T")[0],f=C.getDay(),b=t[x];p.dias.push({dia:r,tipo:b?"festivo":f===0?"domingo":f===6?"sabado":"normal",titulo:b||""})}d.value.push(p)}}async function _(){const t=new fe.Workbook,e=t.addWorksheet("CALENDARIO"),n=["Do","Lu","Ma","Mi","Ju","Vi","Sa"],o=4;e.properties.defaultRowHeight=16;for(let s=1;s<=24;s++)e.getColumn(s).width=o;let a=2;const v=25,p=26,r=27;[{col:v,label:"Festivo"},{col:p,label:"Fecha"},{col:r,label:"Día"}].forEach(({col:s,label:O})=>{const D=e.getCell(1,s);D.value=O,D.font={bold:!0},D.alignment={horizontal:"center"},D.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE5E7EB"}},D.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}});const x={};F.value.forEach(s=>x[s.date]=s.label);let f=0,b=1;for(let s=0;s<12;s++){const O=new Date(c.value,s,1),W=new Date(c.value,s+1,0).getDate(),oe=O.getDay(),k=s%3*8+1;s%3===0&&s>0&&(b=f+2);const ae=O.toLocaleString("es-CO",{month:"long"}).toUpperCase(),Y=e.getCell(b,k);Y.value=`${ae} ${c.value}`,Y.font={bold:!0,size:14,color:{argb:"FF0F172A"}},e.mergeCells(b,k,b,k+6),n.forEach((R,S)=>{const y=e.getCell(b+1,k+S);y.value=R,y.font={bold:!0,color:{argb:"FF1E293B"}},y.alignment={horizontal:"center"},y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE2E8F0"}},y.border={top:{style:"thin",color:{argb:"FFCBD5E1"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}}});let M=1;for(let R=0;M<=W;R++)for(let S=0;S<7;S++){const y=b+2+R,le=k+S;if(f=Math.max(f,y),R===0&&S<oe)continue;if(M>W)break;const V=new Date(c.value,s,M),H=V.toISOString().split("T")[0],q=x[H],g=e.getCell(y,le);g.value=M,g.alignment={horizontal:"center",vertical:"middle"},g.border={top:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}},q?(g.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEE2E2"}},g.font={bold:!0,color:{argb:"FFB91C1C"}},g.note=q,e.getCell(a,v).value=q,e.getCell(a,p).value=H,e.getCell(a,r).value=h(H),[v,p,r].forEach(ne=>{const G=e.getCell(a,ne);G.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},G.alignment={vertical:"middle"}}),a++):V.getDay()===0?g.font={bold:!0,color:{argb:"FFDC2626"}}:V.getDay()===6?g.font={color:{argb:"FF2563EB"}}:g.font={color:{argb:"FF374151"}},M++}}e.getColumn(v).width=30,e.getColumn(p).width=14,e.getColumn(r).width=12;const te=await t.xlsx.writeBuffer();ye.saveAs(new Blob([te]),`calendario_festivos_${c.value}.xlsx`)}return be(c,()=>{w(),E()}),P(()=>{w(),E()}),(t,e)=>{const n=ge("router-link");return j(),L("div",Fe,[l("div",Ee,[l("nav",_e,[l("ol",Ce,[l("li",De,[i(n,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:m(()=>e[2]||(e[2]=[l("i",{class:"inline-block w-4 h-4 mr-1 align-text-bottom"},null,-1),A(" Herramientas ")])),_:1,__:[2]})]),e[3]||(e[3]=l("li",null,[l("i",{class:"inline-block w-4 h-4 text-gray-400 align-text-bottom"})],-1)),e[4]||(e[4]=l("li",{class:"text-gray-700"},"Calendario",-1))])])]),l("div",Se,[e[10]||(e[10]=l("header",{class:"text-center mb-8"},[l("h1",{class:"text-4xl font-extrabold text-primary-700 mb-2"}," Calendario de Festivos ")],-1)),l("div",Be,[l("div",ke,[e[5]||(e[5]=l("label",{for:"anio",class:"text-surface-700 font-medium"},"Selecciona un año:",-1)),i(u(se),{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=o=>c.value=o),options:B.value,class:"w-32",onChange:e[1]||(e[1]=o=>{w(),E()})},null,8,["modelValue","options"])]),i(u(re),{onClick:_,severity:"warning",class:"flex items-center gap-2"},{default:m(()=>[i(u(pe),{class:"w-4 h-4"}),e[6]||(e[6]=A(" Exportar a Excel "))]),_:1,__:[6]})]),i(u(ue),{value:"calendar"},{default:m(()=>[i(u(ie),null,{default:m(()=>[i(u(J),{value:"calendar"},{default:m(()=>e[7]||(e[7]=[A("Calendario")])),_:1,__:[7]}),i(u(J),{value:"festivos"},{default:m(()=>e[8]||(e[8]=[A("Festivos")])),_:1,__:[8]})]),_:1}),i(u(ce),null,{default:m(()=>[i(u(X),{value:"calendar"},{default:m(()=>[l("div",Me,[(j(!0),L(Q,null,Z(d.value,o=>(j(),L("div",{key:o.nombre,class:"rounded border p-3 shadow-sm bg-surface-card"},[l("div",Re,I(o.nombre),1),e[9]||(e[9]=l("div",{class:"grid grid-cols-7 text-center text-xs font-semibold text-surface-600 mb-1"},[l("div",null,"Do"),l("div",null,"Lu"),l("div",null,"Ma"),l("div",null,"Mi"),l("div",null,"Ju"),l("div",null,"Vi"),l("div",null,"Sa")],-1)),l("div",Le,[(j(!0),L(Q,null,Z(o.dias,(a,v)=>(j(),L("div",{key:v,class:he(["rounded px-1 py-0.5",{"bg-red-100 text-red-700 font-semibold cursor-help":a.tipo==="festivo","text-red-500 font-semibold":a.tipo==="domingo","text-blue-500":a.tipo==="sabado","text-surface-700":a.tipo==="normal"}]),title:a.titulo},I(a.dia),11,Ae))),128))])]))),128))])]),_:1}),i(u(X),{value:"festivos"},{default:m(()=>[i(u(de),{value:F.value,class:"p-datatable-sm",stripedRows:"",showGridlines:"",tableStyle:"min-width: 50rem"},{default:m(()=>[i(u(z),{field:"label",header:"Festivo"}),i(u(z),{field:"date",header:"Fecha"}),i(u(z),{header:"Día"},{body:m(({data:o})=>[A(I(h(o.date)),1)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})])])}}}),ze=me(je,[["__scopeId","data-v-f67ba418"]]);export{ze as default};
