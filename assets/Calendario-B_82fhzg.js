import{e as se,c as le,f as ie,g as Q,h as re,i as J}from"./primevue-DjYNv4N8.js";import{e as ce}from"./exceljs.min-BvuckTK0.js";import{c as I}from"./_commonjsHelpers-D6-XlEtG.js";import{F as de}from"./file-spreadsheet-DlGCekxX.js";import{O as ue,r as z,o as Z,w as fe,c as T,e as i,x as g,A as M,f as pe,P as h,d as j,D as P,F as ee,i as te,t as G,p as me}from"./vue-vendor-CyWebr38.js";import{_ as ve}from"./index-DxtJ7Sqj.js";var H={exports:{}},ge=H.exports,oe;function he(){return oe||(oe=1,function(X,p){(function(L,x){x()})(ge,function(){function L(a,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function x(a,t,e){var o=new XMLHttpRequest;o.open("GET",a),o.responseType="blob",o.onload=function(){D(o.response,t,e)},o.onerror=function(){console.error("could not download file")},o.send()}function R(a){var t=new XMLHttpRequest;t.open("HEAD",a,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function b(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(t)}}var m=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof I=="object"&&I.global===I?I:void 0,B=m.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),D=m.saveAs||(typeof window!="object"||window!==m?function(){}:"download"in HTMLAnchorElement.prototype&&!B?function(a,t,e){var o=m.URL||m.webkitURL,s=document.createElement("a");t=t||a.name||"download",s.download=t,s.rel="noopener",typeof a=="string"?(s.href=a,s.origin===location.origin?b(s):R(s.href)?x(a,t,e):b(s,s.target="_blank")):(s.href=o.createObjectURL(a),setTimeout(function(){o.revokeObjectURL(s.href)},4e4),setTimeout(function(){b(s)},0))}:"msSaveOrOpenBlob"in navigator?function(a,t,e){if(t=t||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(L(a,e),t);else if(R(a))x(a,t,e);else{var o=document.createElement("a");o.href=a,o.target="_blank",setTimeout(function(){b(o)})}}:function(a,t,e,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof a=="string")return x(a,t,e);var s=a.type==="application/octet-stream",r=/constructor/i.test(m.HTMLElement)||m.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&r||B)&&typeof FileReader<"u"){var n=new FileReader;n.onloadend=function(){var f=n.result;f=c?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=f:location=f,o=null},n.readAsDataURL(a)}else{var l=m.URL||m.webkitURL,u=l.createObjectURL(a);o?o.location=u:location.href=u,o=null,setTimeout(function(){l.revokeObjectURL(u)},4e4)}});m.saveAs=D.saveAs=D,X.exports=D})}(H)),H.exports}var be=he();const we={class:"min-h-screen mb-16"},xe={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},De={class:"text-sm","aria-label":"Miga de pan"},Fe={class:"list-none p-0 inline-flex space-x-2"},Ee={class:"flex items-center"},ye={class:"container mx-auto px-4 sm:px-6 lg:px-8"},Ce={class:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 mb-6"},_e={class:"flex items-center gap-2 mb-2 sm:mb-0"},Se={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Me={class:"font-bold text-center mb-2"},Be={class:"grid grid-cols-7 text-center text-sm gap-y-1"},ke=["title"],Le=ue({__name:"Calendario",setup(X){const p=z(new Date().getFullYear()),L=z([]);Z(()=>{const t=new Date().getFullYear();for(let e=t-10;e<=t+10;e++)L.value.push(e)});function x(t){function e(n){const l=n.getFullYear(),u=String(n.getMonth()+1).padStart(2,"0"),f=String(n.getDate()).padStart(2,"0");return`${l}-${u}-${f}`}function o(n){const l=n.getDay(),u=l===1?0:(8-l)%7;return new Date(n.getFullYear(),n.getMonth(),n.getDate()+u)}function s(n){const l=n%19,u=Math.floor(n/100),f=n%100,F=Math.floor(u/4),v=u%4,N=Math.floor((u+8)/25),d=Math.floor((u-N+1)/3),E=(19*l+u-F-d+15)%30,y=Math.floor(f/4),O=f%4,$=(32+2*v+2*y-E-O)%7,_=Math.floor((l+11*E+22*$)/451),U=E+$-7*_+114,V=Math.floor(U/31)-1,S=U%31+1;return new Date(n,V,S)}const r=s(t),c=[];return[["Año Nuevo",new Date(t,0,1)],["Día del Trabajo",new Date(t,4,1)],["Independencia de Colombia",new Date(t,6,20)],["Batalla de Boyacá",new Date(t,7,7)],["Inmaculada Concepción",new Date(t,11,8)],["Navidad",new Date(t,11,25)]].forEach(([n,l])=>{c.push({label:n,date:e(l)})}),[["Epifanía",new Date(t,0,6)],["San José",new Date(t,2,19)],["San Pedro y San Pablo",new Date(t,5,29)],["Asunción de la Virgen",new Date(t,7,15)],["Día de la Raza",new Date(t,9,12)],["Todos los Santos",new Date(t,10,1)],["Independencia de Cartagena",new Date(t,10,11)]].forEach(([n,l])=>{c.push({label:n,date:e(o(l))})}),c.push({label:"Jueves Santo",date:e(new Date(r.getTime()-3*864e5))}),c.push({label:"Viernes Santo",date:e(new Date(r.getTime()-2*864e5))}),c.push({label:"Ascensión del Señor",date:e(o(new Date(r.getTime()+43*864e5)))}),c.push({label:"Corpus Christi",date:e(o(new Date(r.getTime()+64*864e5)))}),c.push({label:"Sagrado Corazón",date:e(o(new Date(r.getTime()+71*864e5)))}),c.sort((n,l)=>n.date.localeCompare(l.date)),c}function R(t){const e=["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],[o,s,r]=t.split("-").map(Number);return e[new Date(o,s-1,r).getDay()]}const b=z(x(p.value));function m(){b.value=x(p.value)}const B=z([]);function D(){B.value=[];const t={};b.value.forEach(e=>t[e.date]=e.label);for(let e=0;e<12;e++){const o=new Date(p.value,e,1),r=new Date(p.value,e+1,0).getDate(),c=o.getDay(),n={nombre:o.toLocaleString("es-CO",{month:"long"}).toUpperCase(),dias:[]};for(let l=0;l<c;l++)n.dias.push({dia:"",tipo:"vacio"});for(let l=1;l<=r;l++){const u=new Date(p.value,e,l),f=u.toISOString().split("T")[0],F=u.getDay(),v=t[f];n.dias.push({dia:l,tipo:v?"festivo":F===0?"domingo":F===6?"sabado":"normal",titulo:v||""})}B.value.push(n)}}async function a(){const t=new ce.Workbook,e=t.addWorksheet("CALENDARIO"),o=["Do","Lu","Ma","Mi","Ju","Vi","Sa"],s=4;e.properties.defaultRowHeight=16;for(let d=1;d<=24;d++)e.getColumn(d).width=s;let r=2;const c=25,n=26,l=27;[{col:c,label:"Festivo"},{col:n,label:"Fecha"},{col:l,label:"Día"}].forEach(({col:d,label:E})=>{const y=e.getCell(1,d);y.value=E,y.font={bold:!0},y.alignment={horizontal:"center"},y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE5E7EB"}},y.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}});const f={};b.value.forEach(d=>f[d.date]=d.label);let F=0,v=1;for(let d=0;d<12;d++){const E=new Date(p.value,d,1),O=new Date(p.value,d+1,0).getDate(),$=E.getDay(),_=d%3*8+1;d%3===0&&d>0&&(v=F+2);const U=E.toLocaleString("es-CO",{month:"long"}).toUpperCase(),V=e.getCell(v,_);V.value=`${U} ${p.value}`,V.font={bold:!0,size:14,color:{argb:"FF0F172A"}},e.mergeCells(v,_,v,_+6),o.forEach((A,k)=>{const C=e.getCell(v+1,_+k);C.value=A,C.font={bold:!0,color:{argb:"FF1E293B"}},C.alignment={horizontal:"center"},C.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE2E8F0"}},C.border={top:{style:"thin",color:{argb:"FFCBD5E1"}},bottom:{style:"thin",color:{argb:"FFCBD5E1"}}}});let S=1;for(let A=0;S<=O;A++)for(let k=0;k<7;k++){const C=v+2+A,ae=_+k;if(F=Math.max(F,C),A===0&&k<$)continue;if(S>O)break;const Y=new Date(p.value,d,S),W=Y.toISOString().split("T")[0],q=f[W],w=e.getCell(C,ae);w.value=S,w.alignment={horizontal:"center",vertical:"middle"},w.border={top:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}},q?(w.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFEE2E2"}},w.font={bold:!0,color:{argb:"FFB91C1C"}},w.note=q,e.getCell(r,c).value=q,e.getCell(r,n).value=W,e.getCell(r,l).value=R(W),[c,n,l].forEach(ne=>{const K=e.getCell(r,ne);K.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},K.alignment={vertical:"middle"}}),r++):Y.getDay()===0?w.font={bold:!0,color:{argb:"FFDC2626"}}:Y.getDay()===6?w.font={color:{argb:"FF2563EB"}}:w.font={color:{argb:"FF374151"}},S++}}e.getColumn(c).width=30,e.getColumn(n).width=14,e.getColumn(l).width=12;const N=await t.xlsx.writeBuffer();be.saveAs(new Blob([N]),`calendario_festivos_${p.value}.xlsx`)}return fe(p,()=>{m(),D()}),Z(()=>{m(),D()}),(t,e)=>{const o=pe("router-link");return j(),T("div",we,[i("div",xe,[i("nav",De,[i("ol",Fe,[i("li",Ee,[g(o,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:M(()=>e[2]||(e[2]=[i("i",{class:"inline-block w-4 h-4 mr-1 align-text-bottom"},null,-1),P(" Herramientas ")])),_:1,__:[2]})]),e[3]||(e[3]=i("li",null,[i("i",{class:"inline-block w-4 h-4 text-gray-400 align-text-bottom"})],-1)),e[4]||(e[4]=i("li",{class:"text-gray-700"},"Calendario",-1))])])]),i("div",ye,[e[8]||(e[8]=i("header",{class:"text-center mb-8"},[i("h1",{class:"text-4xl font-extrabold text-primary-700 mb-2"}," Calendario de Festivos ")],-1)),i("div",Ce,[i("div",_e,[e[5]||(e[5]=i("label",{for:"anio",class:"text-surface-700 font-medium"},"Selecciona un año:",-1)),g(h(se),{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),options:L.value,class:"w-32",onChange:e[1]||(e[1]=s=>{m(),D()})},null,8,["modelValue","options"])]),g(h(le),{onClick:a,severity:"warning",class:"flex items-center gap-2"},{default:M(()=>[g(h(de),{class:"w-4 h-4"}),e[6]||(e[6]=P(" Exportar a Excel "))]),_:1,__:[6]})]),g(h(ie),null,{default:M(()=>[g(h(Q),{header:"Calendario",value:"calendario"},{default:M(()=>[i("div",Se,[(j(!0),T(ee,null,te(B.value,s=>(j(),T("div",{key:s.nombre,class:"rounded border p-3 shadow-sm bg-surface-card"},[i("div",Me,G(s.nombre),1),e[7]||(e[7]=i("div",{class:"grid grid-cols-7 text-center text-xs font-semibold text-surface-600 mb-1"},[i("div",null,"Do"),i("div",null,"Lu"),i("div",null,"Ma"),i("div",null,"Mi"),i("div",null,"Ju"),i("div",null,"Vi"),i("div",null,"Sa")],-1)),i("div",Be,[(j(!0),T(ee,null,te(s.dias,(r,c)=>(j(),T("div",{key:c,class:me(["rounded px-1 py-0.5",{"bg-red-100 text-red-700 font-semibold cursor-help":r.tipo==="festivo","text-red-500 font-semibold":r.tipo==="domingo","text-blue-500":r.tipo==="sabado","text-surface-700":r.tipo==="normal"}]),title:r.titulo},G(r.dia),11,ke))),128))])]))),128))])]),_:1}),g(h(Q),{header:"Festivos",value:"festivos"},{default:M(()=>[g(h(re),{value:b.value,class:"p-datatable-sm",stripedRows:"",showGridlines:"",tableStyle:"min-width: 50rem"},{default:M(()=>[g(h(J),{field:"label",header:"Festivo"}),g(h(J),{field:"date",header:"Fecha"}),g(h(J),{header:"Día"},{body:M(({data:s})=>[P(G(R(s.date)),1)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})])])}}}),Ue=ve(Le,[["__scopeId","data-v-bd410b96"]]);export{Ue as default};
