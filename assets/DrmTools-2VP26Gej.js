import{u as X,j as S,k as I,l as C,a as c,m as A}from"./primevue-CxRYVc5z.js";import{c as O,L as q,a as z,_ as G}from"./index-D1cM2nPl.js";import{F as J}from"./file-text-C4949P7a.js";import{H as Q}from"./hash-DEem512F.js";import{P as Z,r as w,c as D,e as s,x as t,B as r,A as v,f as ee,j as H,R as o,t as E,l as _,h as se,d as B}from"./vue-vendor-jWyGKli5.js";const le={class:"min-h-screen mb-16"},te={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},oe={class:"text-sm","aria-label":"Miga de pan"},ae={class:"list-none p-0 inline-flex space-x-2"},re={class:"flex items-center"},ie={class:"container mx-auto px-4 sm:px-6 lg:px-8"},ne={class:"w-full sm:w-4/5 mx-auto grid grid-cols-1 sm:grid-cols-2 gap-4"},de={class:"space-y-4"},ce={class:"flex gap-2"},ue={key:0,class:"surface-ground border-round p-3"},pe={class:"mb-2"},me={class:"mb-2"},fe={class:"mb-2"},be={key:0,class:"space-y-4"},ye={class:"flex items-center gap-2"},ve={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},xe={class:"flex items-center gap-2"},ge={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},we={class:"space-y-4"},ke={class:"flex gap-2"},Se={key:0},Ie={class:"space-y-4"},Ce={class:"flex gap-2"},De={key:0},Ee=Z({__name:"DrmTools",setup(Be){const m=X(),u=w(""),b=w(""),y=w(""),d=w(null),f=w(""),x=w(""),V={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed",PLAYREADY:"9a04f07998404286ab92e65be0885f95",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2"},h=l=>Array.from(l).map(e=>e.toString(16).padStart(2,"0")).join(""),F=()=>{try{if(!u.value)return;const l=atob(u.value),e=new Uint8Array(l.length);for(let k=0;k<l.length;k++)e[k]=l.charCodeAt(k);if(h(e.slice(4,8))!=="70737368")throw new Error("Formato PSSH inválido: header incorrecto");const n=e[8],a=h(e.slice(12,28));let p="Desconocido";a===V.WIDEVINE?p="Widevine":a===V.PLAYREADY?p="PlayReady":a===V.FAIRPLAY&&(p="FairPlay");let T="",N="";if(p==="Widevine"&&n===0){const R=e.slice(34,50);T=h(R),N=btoa(String.fromCharCode.apply(null,[...R]))}d.value={systemId:a,systemName:p,version:n,keyId:T,keyIdBase64:N},m.add({severity:"success",summary:"Éxito",detail:"PSSH decodificado correctamente",life:3e3})}catch(l){m.add({severity:"error",summary:"Error",detail:l instanceof Error?l.message:"Error al decodificar PSSH",life:3e3})}},P=l=>{const e=[];for(let i=0;i<l.length;i+=2)e.push(parseInt(l.slice(i,i+2),16));return e},U=(...l)=>l.flat(),K=l=>{l=l.replace(/=+$/,"");const e=atob(l);let i="";for(let n=0;n<e.length;n++){const a=e.charCodeAt(n);i+=a.toString(16).padStart(2,"0")}return i},L=l=>/^[0-9a-f]{32}$/.test(l),$=l=>{try{return l=l.replace(/=+$/,""),atob(l).length===16}catch{return!1}},Y=()=>{try{if(!b.value)return;let l=b.value.trim().replace(/-/g,"");if(L(l.toLowerCase()))l=l.toLowerCase();else if($(l))l=K(l);else throw new Error("El KeyID debe ser una cadena hexadecimal de 32 caracteres o un Base64 válido que represente 16 bytes.");const e=[0,0,0,50,112,115,115,104,0,0,0,0],i=P("edef8ba979d64acea3c827dcd51d21ed"),n=[0,0,0,18,18,16],a=P(l),p=U(e,i,n,a);y.value=btoa(String.fromCharCode.apply(null,p)),m.add({severity:"success",summary:"Éxito",detail:"PSSH codificado correctamente",life:3e3})}catch(l){m.add({severity:"error",summary:"Error",detail:l instanceof Error?l.message:"Error al codificar PSSH",life:3e3})}},g=async l=>{try{await navigator.clipboard.writeText(l),m.add({severity:"success",summary:"Copiado",detail:"Texto copiado al portapapeles",life:3e3})}catch{m.add({severity:"error",summary:"Error",detail:"Error al copiar al portapapeles",life:3e3})}},j=()=>{u.value="",d.value=null},M=()=>{b.value="",y.value=""};function W(){try{if(!f.value)return;if(!/^(0x[0-9a-fA-F]{2})(,0x[0-9a-fA-F]{2})*$/.test(f.value.trim()))throw new Error("Formato inválido. Usa solo bytes hexadecimales con prefijo 0x, separados por coma. Ejemplo: 0x7b,0x22,0x6b,0x65");const i=f.value.trim().split(",").map(p=>parseInt(p,16)),a=new TextDecoder("utf-8").decode(new Uint8Array(i));x.value=a,m.add({severity:"success",summary:"Éxito",detail:"Decodificado correctamente",life:3e3})}catch(l){x.value="",m.add({severity:"error",summary:"Error",detail:l instanceof Error?l.message:"Error al decodificar los bytes",life:3e3})}}return(l,e)=>{const i=ee("router-link"),n=se("tooltip");return B(),D("div",le,[s("div",te,[s("nav",oe,[s("ol",ae,[s("li",re,[t(i,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:r(()=>e[11]||(e[11]=[s("i",{class:"inline-block w-4 h-4 mr-1 align-text-bottom"},null,-1),v(" Herramientas ")])),_:1,__:[11]})]),e[12]||(e[12]=s("li",null,[s("i",{class:"inline-block w-4 h-4 text-gray-400 align-text-bottom"})],-1)),e[13]||(e[13]=s("li",{class:"text-gray-700"},"DRM Tools",-1))])])]),s("div",ie,[e[30]||(e[30]=s("header",{class:"text-center mb-8"},[s("h1",{class:"text-4xl font-extrabold text-primary-700 mb-2"},"DRM Tools")],-1)),s("div",ne,[t(o(A),{class:"w-full"},{title:r(()=>e[14]||(e[14]=[s("div",{class:"flex items-center gap-2"},[s("i",{class:"pi pi-lock-open"}),s("span",null,"Decodificar PSSH")],-1)])),subtitle:r(()=>e[15]||(e[15]=[v("Decodifica un PSSH de formato Base64 ")])),content:r(()=>[s("div",de,[s("div",null,[e[16]||(e[16]=s("label",{class:"block mb-2"},"PSSH Base64",-1)),t(o(S),null,{default:r(()=>[t(o(I),null,{default:r(()=>[t(o(O),{class:"w-4 h-4"})]),_:1}),t(o(C),{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),rows:"3",class:"w-full",placeholder:"Ingrese el PSSH en formato Base64"},null,8,["modelValue"])]),_:1})]),s("div",ce,[t(o(c),{label:"Decodificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:F,disabled:!u.value},null,8,["disabled"]),t(o(c),{icon:"pi pi-copy",class:"p-button-outlined",onClick:e[1]||(e[1]=()=>g(u.value)),disabled:!u.value},null,8,["disabled"]),t(o(c),{icon:"pi pi-trash",severity:"danger",onClick:j,disabled:!u.value&&!d.value},null,8,["disabled"])]),d.value?(B(),D("div",ue,[s("p",pe,[e[17]||(e[17]=s("strong",null,"Sistema DRM:",-1)),v(" "+E(d.value.systemName),1)]),s("p",me,[e[18]||(e[18]=s("strong",null,"System ID:",-1)),v(" "+E(d.value.systemId),1)]),s("p",fe,[e[19]||(e[19]=s("strong",null,"Versión:",-1)),v(" "+E(d.value.version),1)]),d.value.keyId?(B(),D("div",be,[s("div",null,[e[20]||(e[20]=s("p",{class:"font-bold mb-2"},"Key ID (HEX):",-1)),s("div",ye,[s("code",ve,E(d.value.keyId),1),_(t(o(c),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:e[2]||(e[2]=()=>g(d.value.keyId))},null,512),[[n,"Copiar Key ID (HEX)",void 0,{top:!0}]])])]),s("div",null,[e[21]||(e[21]=s("p",{class:"font-bold mb-2"},"Key ID (Base64):",-1)),s("div",xe,[s("code",ge,E(d.value.keyIdBase64),1),_(t(o(c),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:e[3]||(e[3]=()=>g(d.value.keyIdBase64))},null,512),[[n,"Copiar Key ID (Base64)",void 0,{top:!0}]])])])])):H("",!0)])):H("",!0)])]),_:1}),t(o(A),{class:"w-full"},{title:r(()=>e[22]||(e[22]=[s("div",{class:"flex items-center gap-2"},[s("i",{class:"pi pi-lock"}),s("span",null,"Codificar PSSH")],-1)])),subtitle:r(()=>e[23]||(e[23]=[v(" Codifica un Key ID en formato PSSH Base64 ")])),content:r(()=>[s("div",we,[s("div",null,[e[24]||(e[24]=s("label",{class:"block mb-2"},"Texto a codificar",-1)),t(o(S),null,{default:r(()=>[t(o(I),null,{default:r(()=>[t(o(q),{class:"w-4 h-4"})]),_:1}),t(o(C),{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=a=>b.value=a),rows:"3",class:"w-full",placeholder:"Ingrese el Key ID en HEX (32 caracteres) o Base64 (22-24 caracteres)"},null,8,["modelValue"])]),_:1})]),s("div",ke,[t(o(c),{label:"Codificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:Y,disabled:!b.value},null,8,["disabled"]),t(o(c),{icon:"pi pi-trash",severity:"danger",onClick:M,disabled:!b.value&&!y.value},null,8,["disabled"])]),y.value?(B(),D("div",Se,[e[25]||(e[25]=s("label",{class:"block mb-2"},"Resultado en Base64",-1)),t(o(S),null,{default:r(()=>[t(o(I),null,{default:r(()=>[t(o(J),{class:"w-4 h-4"})]),_:1}),t(o(C),{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=a=>y.value=a),rows:"3",class:"w-full mb-2",readonly:""},null,8,["modelValue"])]),_:1}),t(o(c),{icon:"pi pi-copy",label:"Copiar resultado",class:"p-button-outlined w-full",onClick:e[6]||(e[6]=()=>g(y.value))})])):H("",!0)])]),_:1}),t(o(A),{class:"w-full mt-4"},{title:r(()=>e[26]||(e[26]=[s("div",{class:"flex items-center gap-2"},[s("i",{class:"pi pi-code"}),s("span",null,"Decodificar bytes hex a texto")],-1)])),subtitle:r(()=>e[27]||(e[27]=[v(" Convierte una secuencia de bytes en formato 0xNN,0xNN,... a texto legible (UTF-8) ")])),content:r(()=>[s("div",Ie,[s("div",null,[e[28]||(e[28]=s("label",{class:"block mb-2"},"Bytes hexadecimales",-1)),t(o(S),null,{default:r(()=>[t(o(I),null,{default:r(()=>[t(o(z),{class:"w-4 h-4"})]),_:1}),t(o(C),{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=a=>f.value=a),rows:"3",class:"w-full",placeholder:"Ejemplo: 0x7b,0x22,0x6b,0x65,0x79,0x73,0x22,0x3a,0x5b,0x7b,0x22,0x6b,0x74,0x79,0x22,0x3a,0x22,0x6f,0x63,0x74,0x22"},null,8,["modelValue"])]),_:1})]),s("div",Ce,[t(o(c),{label:"Decodificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:W,disabled:!f.value},null,8,["disabled"]),_(t(o(c),{icon:"pi pi-copy",class:"p-button-outlined",onClick:e[8]||(e[8]=()=>g(f.value)),disabled:!f.value},null,8,["disabled"]),[[n,"Copiar entrada",void 0,{top:!0}]])]),x.value?(B(),D("div",De,[e[29]||(e[29]=s("label",{class:"block mb-2"},"Texto decodificado",-1)),t(o(S),null,{default:r(()=>[t(o(I),null,{default:r(()=>[t(o(Q),{class:"w-4 h-4"})]),_:1}),t(o(C),{modelValue:x.value,"onUpdate:modelValue":e[9]||(e[9]=a=>x.value=a),rows:"3",class:"w-full mb-2",readonly:""},null,8,["modelValue"])]),_:1}),t(o(c),{icon:"pi pi-copy",label:"Copiar resultado",class:"p-button-outlined w-full",onClick:e[10]||(e[10]=()=>g(x.value))})])):H("",!0)])]),_:1})])])])}}}),Pe=G(Ee,[["__scopeId","data-v-058a0070"]]);export{Pe as default};
