import{u as $,g as A,f as D,a as c}from"./primevue-BjsjsmTx.js";import{N as M,r as I,c as x,e as t,x as a,B as y,O as r,F as U,d as k,j as E,A as b,t as g,l as h,h as W}from"./vue-vendor-Bqr_0FhS.js";import{_ as X}from"./index-Ca8HENRs.js";const j={class:"w-full sm:w-4/5 mx-auto grid grid-cols-1 sm:grid-cols-2 gap-4"},O={class:"space-y-4"},q={class:"flex gap-2"},z={key:0,class:"surface-ground border-round p-3"},G={class:"mb-2"},J={class:"mb-2"},Q={class:"mb-2"},Z={key:0,class:"space-y-4"},ee={class:"flex items-center gap-2"},se={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},te={class:"flex items-center gap-2"},oe={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},le={class:"space-y-4"},ae={class:"flex gap-2"},re={key:0},ie=M({__name:"DrmTools",setup(de){const m=$(),d=I(""),u=I(""),p=I(""),i=I(null),w={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed",PLAYREADY:"9a04f07998404286ab92e65be0885f95",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2"},C=s=>Array.from(s).map(e=>e.toString(16).padStart(2,"0")).join(""),T=()=>{try{if(!d.value)return;const s=atob(d.value),e=new Uint8Array(s.length);for(let v=0;v<s.length;v++)e[v]=s.charCodeAt(v);if(C(e.slice(4,8))!=="70737368")throw new Error("Formato PSSH inválido: header incorrecto");const o=e[8],n=C(e.slice(12,28));let f="Desconocido";n===w.WIDEVINE?f="Widevine":n===w.PLAYREADY?f="PlayReady":n===w.FAIRPLAY&&(f="FairPlay");let H="",P="";if(f==="Widevine"&&o===0){const V=e.slice(34,50);H=C(V),P=btoa(String.fromCharCode.apply(null,[...V]))}i.value={systemId:n,systemName:f,version:o,keyId:H,keyIdBase64:P},m.add({severity:"success",summary:"Éxito",detail:"PSSH decodificado correctamente",life:3e3})}catch(s){m.add({severity:"error",summary:"Error",detail:s instanceof Error?s.message:"Error al decodificar PSSH",life:3e3})}},B=s=>{const e=[];for(let l=0;l<s.length;l+=2)e.push(parseInt(s.slice(l,l+2),16));return e},N=(...s)=>s.flat(),R=s=>{s=s.replace(/=+$/,"");const e=atob(s);let l="";for(let o=0;o<e.length;o++){const n=e.charCodeAt(o);l+=n.toString(16).padStart(2,"0")}return l},K=s=>/^[0-9a-f]{32}$/.test(s),_=s=>{try{return s=s.replace(/=+$/,""),atob(s).length===16}catch{return!1}},Y=()=>{try{if(!u.value)return;let s=u.value.trim().replace(/-/g,"");if(K(s.toLowerCase()))s=s.toLowerCase();else if(_(s))s=R(s);else throw new Error("El KeyID debe ser una cadena hexadecimal de 32 caracteres o un Base64 válido que represente 16 bytes.");const e=[0,0,0,50,112,115,115,104,0,0,0,0],l=B("edef8ba979d64acea3c827dcd51d21ed"),o=[0,0,0,18,18,16],n=B(s),f=N(e,l,o,n);p.value=btoa(String.fromCharCode.apply(null,f)),m.add({severity:"success",summary:"Éxito",detail:"PSSH codificado correctamente",life:3e3})}catch(s){m.add({severity:"error",summary:"Error",detail:s instanceof Error?s.message:"Error al codificar PSSH",life:3e3})}},S=async s=>{try{await navigator.clipboard.writeText(s),m.add({severity:"success",summary:"Copiado",detail:"Texto copiado al portapapeles",life:3e3})}catch{m.add({severity:"error",summary:"Error",detail:"Error al copiar al portapapeles",life:3e3})}},F=()=>{d.value="",i.value=null},L=()=>{u.value="",p.value=""};return(s,e)=>{const l=W("tooltip");return k(),x(U,null,[e[19]||(e[19]=t("h1",{class:"text-2xl font-bold"},"DRM Tools",-1)),t("div",j,[a(r(A),{class:"w-full"},{title:y(()=>e[7]||(e[7]=[t("div",{class:"flex items-center gap-2"},[t("i",{class:"pi pi-lock-open"}),t("span",null,"Decodificar PSSH")],-1)])),subtitle:y(()=>e[8]||(e[8]=[b("Decodifica un PSSH de formato Base64 ")])),content:y(()=>[t("div",O,[t("div",null,[e[9]||(e[9]=t("label",{class:"block mb-2"},"PSSH Base64",-1)),a(r(D),{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=o=>d.value=o),rows:"3",class:"w-full",placeholder:"Ingrese el PSSH en formato Base64"},null,8,["modelValue"])]),t("div",q,[a(r(c),{label:"Decodificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:T,disabled:!d.value},null,8,["disabled"]),a(r(c),{icon:"pi pi-copy",class:"p-button-outlined",onClick:e[1]||(e[1]=()=>S(d.value)),disabled:!d.value},null,8,["disabled"]),a(r(c),{icon:"pi pi-trash",severity:"danger",onClick:F,disabled:!d.value&&!i.value},null,8,["disabled"])]),i.value?(k(),x("div",z,[t("p",G,[e[10]||(e[10]=t("strong",null,"Sistema DRM:",-1)),b(" "+g(i.value.systemName),1)]),t("p",J,[e[11]||(e[11]=t("strong",null,"System ID:",-1)),b(" "+g(i.value.systemId),1)]),t("p",Q,[e[12]||(e[12]=t("strong",null,"Versión:",-1)),b(" "+g(i.value.version),1)]),i.value.keyId?(k(),x("div",Z,[t("div",null,[e[13]||(e[13]=t("p",{class:"font-bold mb-2"},"Key ID (HEX):",-1)),t("div",ee,[t("code",se,g(i.value.keyId),1),h(a(r(c),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:e[2]||(e[2]=()=>S(i.value.keyId))},null,512),[[l,"Copiar Key ID (HEX)",void 0,{top:!0}]])])]),t("div",null,[e[14]||(e[14]=t("p",{class:"font-bold mb-2"},"Key ID (Base64):",-1)),t("div",te,[t("code",oe,g(i.value.keyIdBase64),1),h(a(r(c),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:e[3]||(e[3]=()=>S(i.value.keyIdBase64))},null,512),[[l,"Copiar Key ID (Base64)",void 0,{top:!0}]])])])])):E("",!0)])):E("",!0)])]),_:1}),a(r(A),{class:"w-full"},{title:y(()=>e[15]||(e[15]=[t("div",{class:"flex items-center gap-2"},[t("i",{class:"pi pi-lock"}),t("span",null,"Codificar PSSH")],-1)])),subtitle:y(()=>e[16]||(e[16]=[b(" Codifica un Key ID en formato PSSH Base64 ")])),content:y(()=>[t("div",le,[t("div",null,[e[17]||(e[17]=t("label",{class:"block mb-2"},"Texto a codificar",-1)),a(r(D),{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=o=>u.value=o),rows:"3",class:"w-full",placeholder:"Ingrese el Key ID en HEX (32 caracteres) o Base64 (22-24 caracteres)"},null,8,["modelValue"])]),t("div",ae,[a(r(c),{label:"Codificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:Y,disabled:!u.value},null,8,["disabled"]),a(r(c),{icon:"pi pi-trash",severity:"danger",onClick:L,disabled:!u.value&&!p.value},null,8,["disabled"])]),p.value?(k(),x("div",re,[e[18]||(e[18]=t("label",{class:"block mb-2"},"Resultado en Base64",-1)),a(r(D),{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=o=>p.value=o),rows:"3",class:"w-full mb-2",readonly:""},null,8,["modelValue"]),a(r(c),{icon:"pi pi-copy",label:"Copiar resultado",class:"p-button-outlined w-full",onClick:e[6]||(e[6]=()=>S(p.value))})])):E("",!0)])]),_:1})])],64)}}}),pe=X(ie,[["__scopeId","data-v-ab905e62"]]);export{pe as default};
