import{u as $,j as k,a as d,l as H}from"./primevue-BtpsDkMC.js";import{P as W,r as w,c as I,e as s,x as l,B as c,A as v,f as X,j as E,R as a,t as C,l as A,h as O,d as D}from"./vue-vendor-DSKsDytq.js";import{_ as q}from"./index-4AzEWo-O.js";const z={class:"min-h-screen mb-16"},G={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},J={class:"text-sm","aria-label":"Miga de pan"},Q={class:"list-none p-0 inline-flex space-x-2"},Z={class:"flex items-center"},ee={class:"container mx-auto px-4 sm:px-6 lg:px-8"},se={class:"w-full sm:w-4/5 mx-auto grid grid-cols-1 sm:grid-cols-2 gap-4"},te={class:"space-y-4"},oe={class:"flex gap-2"},le={key:0,class:"surface-ground border-round p-3"},ae={class:"mb-2"},re={class:"mb-2"},ie={class:"mb-2"},ne={key:0,class:"space-y-4"},de={class:"flex items-center gap-2"},ce={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},ue={class:"flex items-center gap-2"},pe={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},me={class:"space-y-4"},fe={class:"flex gap-2"},be={key:0},ye={class:"space-y-4"},ve={class:"flex gap-2"},xe={key:0},ge=W({__name:"DrmTools",setup(we){const m=$(),u=w(""),b=w(""),y=w(""),n=w(null),f=w(""),x=w(""),B={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed",PLAYREADY:"9a04f07998404286ab92e65be0885f95",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2"},V=t=>Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join(""),R=()=>{try{if(!u.value)return;const t=atob(u.value),e=new Uint8Array(t.length);for(let S=0;S<t.length;S++)e[S]=t.charCodeAt(S);if(V(e.slice(4,8))!=="70737368")throw new Error("Formato PSSH inválido: header incorrecto");const i=e[8],o=V(e.slice(12,28));let p="Desconocido";o===B.WIDEVINE?p="Widevine":o===B.PLAYREADY?p="PlayReady":o===B.FAIRPLAY&&(p="FairPlay");let T="",h="";if(p==="Widevine"&&i===0){const N=e.slice(34,50);T=V(N),h=btoa(String.fromCharCode.apply(null,[...N]))}n.value={systemId:o,systemName:p,version:i,keyId:T,keyIdBase64:h},m.add({severity:"success",summary:"Éxito",detail:"PSSH decodificado correctamente",life:3e3})}catch(t){m.add({severity:"error",summary:"Error",detail:t instanceof Error?t.message:"Error al decodificar PSSH",life:3e3})}},P=t=>{const e=[];for(let r=0;r<t.length;r+=2)e.push(parseInt(t.slice(r,r+2),16));return e},_=(...t)=>t.flat(),U=t=>{t=t.replace(/=+$/,"");const e=atob(t);let r="";for(let i=0;i<e.length;i++){const o=e.charCodeAt(i);r+=o.toString(16).padStart(2,"0")}return r},F=t=>/^[0-9a-f]{32}$/.test(t),K=t=>{try{return t=t.replace(/=+$/,""),atob(t).length===16}catch{return!1}},Y=()=>{try{if(!b.value)return;let t=b.value.trim().replace(/-/g,"");if(F(t.toLowerCase()))t=t.toLowerCase();else if(K(t))t=U(t);else throw new Error("El KeyID debe ser una cadena hexadecimal de 32 caracteres o un Base64 válido que represente 16 bytes.");const e=[0,0,0,50,112,115,115,104,0,0,0,0],r=P("edef8ba979d64acea3c827dcd51d21ed"),i=[0,0,0,18,18,16],o=P(t),p=_(e,r,i,o);y.value=btoa(String.fromCharCode.apply(null,p)),m.add({severity:"success",summary:"Éxito",detail:"PSSH codificado correctamente",life:3e3})}catch(t){m.add({severity:"error",summary:"Error",detail:t instanceof Error?t.message:"Error al codificar PSSH",life:3e3})}},g=async t=>{try{await navigator.clipboard.writeText(t),m.add({severity:"success",summary:"Copiado",detail:"Texto copiado al portapapeles",life:3e3})}catch{m.add({severity:"error",summary:"Error",detail:"Error al copiar al portapapeles",life:3e3})}},j=()=>{u.value="",n.value=null},L=()=>{b.value="",y.value=""};function M(){try{if(!f.value)return;if(!/^(0x[0-9a-fA-F]{2})(,0x[0-9a-fA-F]{2})*$/.test(f.value.trim()))throw new Error("Formato inválido. Usa solo bytes hexadecimales con prefijo 0x, separados por coma. Ejemplo: 0x7b,0x22,0x6b,0x65");const r=f.value.trim().split(",").map(p=>parseInt(p,16)),o=new TextDecoder("utf-8").decode(new Uint8Array(r));x.value=o,m.add({severity:"success",summary:"Éxito",detail:"Decodificado correctamente",life:3e3})}catch(t){x.value="",m.add({severity:"error",summary:"Error",detail:t instanceof Error?t.message:"Error al decodificar los bytes",life:3e3})}}return(t,e)=>{const r=X("router-link"),i=O("tooltip");return D(),I("div",z,[s("div",G,[s("nav",J,[s("ol",Q,[s("li",Z,[l(r,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:c(()=>e[11]||(e[11]=[s("i",{class:"inline-block w-4 h-4 mr-1 align-text-bottom"},null,-1),v(" Herramientas ")])),_:1,__:[11]})]),e[12]||(e[12]=s("li",null,[s("i",{class:"inline-block w-4 h-4 text-gray-400 align-text-bottom"})],-1)),e[13]||(e[13]=s("li",{class:"text-gray-700"},"DRM Tools",-1))])])]),s("div",ee,[e[30]||(e[30]=s("header",{class:"text-center mb-8"},[s("h1",{class:"text-4xl font-extrabold text-primary-700 mb-2"},"DRM Tools")],-1)),s("div",se,[l(a(H),{class:"w-full"},{title:c(()=>e[14]||(e[14]=[s("div",{class:"flex items-center gap-2"},[s("i",{class:"pi pi-lock-open"}),s("span",null,"Decodificar PSSH")],-1)])),subtitle:c(()=>e[15]||(e[15]=[v("Decodifica un PSSH de formato Base64 ")])),content:c(()=>[s("div",te,[s("div",null,[e[16]||(e[16]=s("label",{class:"block mb-2"},"PSSH Base64",-1)),l(a(k),{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=o=>u.value=o),rows:"3",class:"w-full",placeholder:"Ingrese el PSSH en formato Base64"},null,8,["modelValue"])]),s("div",oe,[l(a(d),{label:"Decodificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:R,disabled:!u.value},null,8,["disabled"]),l(a(d),{icon:"pi pi-copy",class:"p-button-outlined",onClick:e[1]||(e[1]=()=>g(u.value)),disabled:!u.value},null,8,["disabled"]),l(a(d),{icon:"pi pi-trash",severity:"danger",onClick:j,disabled:!u.value&&!n.value},null,8,["disabled"])]),n.value?(D(),I("div",le,[s("p",ae,[e[17]||(e[17]=s("strong",null,"Sistema DRM:",-1)),v(" "+C(n.value.systemName),1)]),s("p",re,[e[18]||(e[18]=s("strong",null,"System ID:",-1)),v(" "+C(n.value.systemId),1)]),s("p",ie,[e[19]||(e[19]=s("strong",null,"Versión:",-1)),v(" "+C(n.value.version),1)]),n.value.keyId?(D(),I("div",ne,[s("div",null,[e[20]||(e[20]=s("p",{class:"font-bold mb-2"},"Key ID (HEX):",-1)),s("div",de,[s("code",ce,C(n.value.keyId),1),A(l(a(d),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:e[2]||(e[2]=()=>g(n.value.keyId))},null,512),[[i,"Copiar Key ID (HEX)",void 0,{top:!0}]])])]),s("div",null,[e[21]||(e[21]=s("p",{class:"font-bold mb-2"},"Key ID (Base64):",-1)),s("div",ue,[s("code",pe,C(n.value.keyIdBase64),1),A(l(a(d),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:e[3]||(e[3]=()=>g(n.value.keyIdBase64))},null,512),[[i,"Copiar Key ID (Base64)",void 0,{top:!0}]])])])])):E("",!0)])):E("",!0)])]),_:1}),l(a(H),{class:"w-full"},{title:c(()=>e[22]||(e[22]=[s("div",{class:"flex items-center gap-2"},[s("i",{class:"pi pi-lock"}),s("span",null,"Codificar PSSH")],-1)])),subtitle:c(()=>e[23]||(e[23]=[v(" Codifica un Key ID en formato PSSH Base64 ")])),content:c(()=>[s("div",me,[s("div",null,[e[24]||(e[24]=s("label",{class:"block mb-2"},"Texto a codificar",-1)),l(a(k),{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=o=>b.value=o),rows:"3",class:"w-full",placeholder:"Ingrese el Key ID en HEX (32 caracteres) o Base64 (22-24 caracteres)"},null,8,["modelValue"])]),s("div",fe,[l(a(d),{label:"Codificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:Y,disabled:!b.value},null,8,["disabled"]),l(a(d),{icon:"pi pi-trash",severity:"danger",onClick:L,disabled:!b.value&&!y.value},null,8,["disabled"])]),y.value?(D(),I("div",be,[e[25]||(e[25]=s("label",{class:"block mb-2"},"Resultado en Base64",-1)),l(a(k),{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=o=>y.value=o),rows:"3",class:"w-full mb-2",readonly:""},null,8,["modelValue"]),l(a(d),{icon:"pi pi-copy",label:"Copiar resultado",class:"p-button-outlined w-full",onClick:e[6]||(e[6]=()=>g(y.value))})])):E("",!0)])]),_:1}),l(a(H),{class:"w-full mt-4"},{title:c(()=>e[26]||(e[26]=[s("div",{class:"flex items-center gap-2"},[s("i",{class:"pi pi-code"}),s("span",null,"Decodificar bytes hex a texto")],-1)])),subtitle:c(()=>e[27]||(e[27]=[v(" Convierte una secuencia de bytes en formato 0xNN,0xNN,... a texto legible (UTF-8) ")])),content:c(()=>[s("div",ye,[s("div",null,[e[28]||(e[28]=s("label",{class:"block mb-2"},"Bytes hexadecimales",-1)),l(a(k),{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=o=>f.value=o),rows:"3",class:"w-full",placeholder:"Ejemplo: 0x7b,0x22,0x6b,0x65,0x79,0x73,0x22,0x3a,0x5b,0x7b,0x22,0x6b,0x74,0x79,0x22,0x3a,0x22,0x6f,0x63,0x74,0x22"},null,8,["modelValue"])]),s("div",ve,[l(a(d),{label:"Decodificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:M,disabled:!f.value},null,8,["disabled"]),A(l(a(d),{icon:"pi pi-copy",class:"p-button-outlined",onClick:e[8]||(e[8]=()=>g(f.value)),disabled:!f.value},null,8,["disabled"]),[[i,"Copiar entrada",void 0,{top:!0}]])]),x.value?(D(),I("div",xe,[e[29]||(e[29]=s("label",{class:"block mb-2"},"Texto decodificado",-1)),l(a(k),{modelValue:x.value,"onUpdate:modelValue":e[9]||(e[9]=o=>x.value=o),rows:"3",class:"w-full mb-2",readonly:""},null,8,["modelValue"]),l(a(d),{icon:"pi pi-copy",label:"Copiar resultado",class:"p-button-outlined w-full",onClick:e[10]||(e[10]=()=>g(x.value))})])):E("",!0)])]),_:1})])])])}}}),Ce=q(ge,[["__scopeId","data-v-15905286"]]);export{Ce as default};
