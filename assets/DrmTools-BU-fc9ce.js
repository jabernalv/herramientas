import{u as Q,f as C,g as h,k as _,a as n,m as H}from"./primevue-CTM77RMy.js";import{_ as Z}from"./BreadcrumbNav.vue_vue_type_script_setup_true_lang-B4aGCTLN.js";import{S as ee,L as $,a as se,g as K,_ as te}from"./index-BSjldw0I.js";import{A as P}from"./arrow-right-p3ksMa1M.js";import{C as g}from"./copy-BiFTJGW3.js";import{T as Y}from"./trash-2-CIEUEUdj.js";import{L as le}from"./lock-open-CIiLiMI6.js";import{H as oe}from"./hash-rpP7jw6j.js";import{P as ae,r as S,c as D,x as t,e as o,B as a,R as s,d as v,j as B,A as k,t as E,l as T,k as N,h as re}from"./vue-vendor-ByoO1CXK.js";const de={class:"min-h-screen mb-16"},ie={class:"container mx-auto px-4 sm:px-6 lg:px-8"},ne={class:"w-full sm:w-4/5 mx-auto grid grid-cols-1 sm:grid-cols-2 gap-4"},ce={class:"flex items-center gap-2"},ue={class:"space-y-4"},me={class:"flex gap-2"},fe={key:0,class:"surface-ground border-round p-3"},pe={class:"mb-2"},ve={class:"mb-2"},be={class:"mb-2"},ye={key:0,class:"space-y-4"},xe={class:"flex items-center gap-2"},we={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},ge={class:"flex items-center gap-2"},Se={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},ke={class:"flex items-center gap-2"},Ie={class:"space-y-4"},Ce={class:"flex gap-2"},he={key:0},_e={class:"flex items-center gap-2"},De={class:"space-y-4"},Ee={class:"flex gap-2"},Be={key:0},Ve=ae({__name:"DrmTools",setup(Ae){const f=Q(),u=S(""),b=S(""),y=S(""),i=S(null),p=S(""),x=S(""),V={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed",PLAYREADY:"9a04f07998404286ab92e65be0885f95",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2"},A=l=>Array.from(l).map(e=>e.toString(16).padStart(2,"0")).join(""),j=()=>{try{if(!u.value)return;const l=atob(u.value),e=new Uint8Array(l.length);for(let I=0;I<l.length;I++)e[I]=l.charCodeAt(I);if(A(e.slice(4,8))!=="70737368")throw new Error("Formato PSSH inválido: header incorrecto");const r=e[8],c=A(e.slice(12,28));let m="Desconocido";c===V.WIDEVINE?m="Widevine":c===V.PLAYREADY?m="PlayReady":c===V.FAIRPLAY&&(m="FairPlay");let L="",F="";if(m==="Widevine"&&r===0){const U=e.slice(34,50);L=A(U),F=btoa(String.fromCharCode.apply(null,[...U]))}i.value={systemId:c,systemName:m,version:r,keyId:L,keyIdBase64:F},f.add({severity:"success",summary:"Éxito",detail:"PSSH decodificado correctamente",life:3e3})}catch(l){f.add({severity:"error",summary:"Error",detail:l instanceof Error?l.message:"Error al decodificar PSSH",life:3e3})}},R=l=>{const e=[];for(let d=0;d<l.length;d+=2)e.push(parseInt(l.slice(d,d+2),16));return e},M=(...l)=>l.flat(),W=l=>{l=l.replace(/=+$/,"");const e=atob(l);let d="";for(let r=0;r<e.length;r++){const c=e.charCodeAt(r);d+=c.toString(16).padStart(2,"0")}return d},O=l=>/^[0-9a-f]{32}$/.test(l),X=l=>{try{return l=l.replace(/=+$/,""),atob(l).length===16}catch{return!1}},q=()=>{try{if(!b.value)return;let l=b.value.trim().replace(/-/g,"");if(O(l.toLowerCase()))l=l.toLowerCase();else if(X(l))l=W(l);else throw new Error("El KeyID debe ser una cadena hexadecimal de 32 caracteres o un Base64 válido que represente 16 bytes.");const e=[0,0,0,50,112,115,115,104,0,0,0,0],d=R("edef8ba979d64acea3c827dcd51d21ed"),r=[0,0,0,18,18,16],c=R(l),m=M(e,d,r,c);y.value=btoa(String.fromCharCode.apply(null,m)),f.add({severity:"success",summary:"Éxito",detail:"PSSH codificado correctamente",life:3e3})}catch(l){f.add({severity:"error",summary:"Error",detail:l instanceof Error?l.message:"Error al codificar PSSH",life:3e3})}},w=async l=>{try{await navigator.clipboard.writeText(l),f.add({severity:"success",summary:"Copiado",detail:"Texto copiado al portapapeles",life:3e3})}catch{f.add({severity:"error",summary:"Error",detail:"Error al copiar al portapapeles",life:3e3})}},z=()=>{u.value="",i.value=null},G=()=>{b.value="",y.value=""};function J(){try{if(!p.value)return;if(!/^(0x[0-9a-fA-F]{2})(,0x[0-9a-fA-F]{2})*$/.test(p.value.trim()))throw new Error("Formato inválido. Usa solo bytes hexadecimales con prefijo 0x, separados por coma. Ejemplo: 0x7b,0x22,0x6b,0x65");const d=p.value.trim().split(",").map(m=>parseInt(m,16)),c=new TextDecoder("utf-8").decode(new Uint8Array(d));x.value=c,f.add({severity:"success",summary:"Éxito",detail:"Decodificado correctamente",life:3e3})}catch(l){x.value="",f.add({severity:"error",summary:"Error",detail:l instanceof Error?l.message:"Error al decodificar los bytes",life:3e3})}}return(l,e)=>{const d=re("tooltip");return v(),D("div",de,[t(Z),o("div",ie,[e[27]||(e[27]=o("header",{class:"text-center mb-8"},[o("h1",{class:"text-4xl font-extrabold text-primary-700 mb-2"},"DRM Tools")],-1)),o("div",ne,[t(s(H),{class:"w-full"},{title:a(()=>[o("div",ce,[t(s(le),{class:"w-4 h-4"}),e[11]||(e[11]=o("span",null,"Decodificar PSSH",-1))])]),subtitle:a(()=>e[12]||(e[12]=[k("Decodifica un PSSH de formato Base64 ")])),content:a(()=>[o("div",ue,[o("div",null,[e[13]||(e[13]=o("label",{class:"block mb-2"},"PSSH Base64",-1)),t(s(C),null,{default:a(()=>[t(s(h),null,{default:a(()=>[t(s(ee),{class:"w-4 h-4"})]),_:1}),t(s(_),{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=r=>u.value=r),rows:"3",class:"w-full",placeholder:"Ingrese el PSSH en formato Base64"},null,8,["modelValue"])]),_:1})]),o("div",me,[t(s(n),{label:"Decodificar",class:"p-button-success flex-grow",onClick:j,disabled:!u.value},{icon:a(()=>[t(s(P),{class:"w-4 h-4 mr-2"})]),_:1},8,["disabled"]),t(s(n),{class:"p-button-outlined",onClick:e[1]||(e[1]=()=>w(u.value)),disabled:!u.value},{icon:a(()=>[t(s(g),{class:"w-4 h-4"})]),_:1},8,["disabled"]),t(s(n),{severity:"danger",onClick:z,disabled:!u.value&&!i.value},{icon:a(()=>[t(s(Y),{class:"w-4 h-4"})]),_:1},8,["disabled"])]),i.value?(v(),D("div",fe,[o("p",pe,[e[14]||(e[14]=o("strong",null,"Sistema DRM:",-1)),k(" "+E(i.value.systemName),1)]),o("p",ve,[e[15]||(e[15]=o("strong",null,"System ID:",-1)),k(" "+E(i.value.systemId),1)]),o("p",be,[e[16]||(e[16]=o("strong",null,"Versión:",-1)),k(" "+E(i.value.version),1)]),i.value.keyId?(v(),D("div",ye,[o("div",null,[e[17]||(e[17]=o("p",{class:"font-bold mb-2"},"Key ID (HEX):",-1)),o("div",xe,[o("code",we,E(i.value.keyId),1),T((v(),N(s(n),{class:"p-button-text p-button-sm",onClick:e[2]||(e[2]=()=>w(i.value.keyId))},{icon:a(()=>[t(s(g),{class:"w-4 h-4"})]),_:1})),[[d,"Copiar Key ID (HEX)",void 0,{top:!0}]])])]),o("div",null,[e[18]||(e[18]=o("p",{class:"font-bold mb-2"},"Key ID (Base64):",-1)),o("div",ge,[o("code",Se,E(i.value.keyIdBase64),1),T((v(),N(s(n),{class:"p-button-text p-button-sm",onClick:e[3]||(e[3]=()=>w(i.value.keyIdBase64))},{icon:a(()=>[t(s(g),{class:"w-4 h-4"})]),_:1})),[[d,"Copiar Key ID (Base64)",void 0,{top:!0}]])])])])):B("",!0)])):B("",!0)])]),_:1}),t(s(H),{class:"w-full"},{title:a(()=>[o("div",ke,[t(s($),{class:"w-4 h-4"}),e[19]||(e[19]=o("span",null,"Codificar PSSH",-1))])]),subtitle:a(()=>e[20]||(e[20]=[k(" Codifica un Key ID en formato PSSH Base64 ")])),content:a(()=>[o("div",Ie,[o("div",null,[e[21]||(e[21]=o("label",{class:"block mb-2"},"Texto a codificar",-1)),t(s(C),null,{default:a(()=>[t(s(h),null,{default:a(()=>[t(s($),{class:"w-4 h-4"})]),_:1}),t(s(_),{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=r=>b.value=r),rows:"3",class:"w-full",placeholder:"Ingrese el Key ID en HEX (32 caracteres) o Base64 (22-24 caracteres)"},null,8,["modelValue"])]),_:1})]),o("div",Ce,[t(s(n),{label:"Codificar",class:"p-button-success flex-grow",onClick:q,disabled:!b.value},{icon:a(()=>[t(s(P),{class:"w-4 h-4 mr-2"})]),_:1},8,["disabled"]),t(s(n),{severity:"danger",onClick:G,disabled:!b.value&&!y.value},{icon:a(()=>[t(s(Y),{class:"w-4 h-4"})]),_:1},8,["disabled"])]),y.value?(v(),D("div",he,[e[22]||(e[22]=o("label",{class:"block mb-2"},"Resultado en Base64",-1)),t(s(C),null,{default:a(()=>[t(s(h),null,{default:a(()=>[t(s(se),{class:"w-4 h-4"})]),_:1}),t(s(_),{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=r=>y.value=r),rows:"3",class:"w-full mb-2",readonly:""},null,8,["modelValue"])]),_:1}),t(s(n),{label:"Copiar resultado",class:"p-button-outlined w-full",onClick:e[6]||(e[6]=()=>w(y.value))},{icon:a(()=>[t(s(g),{class:"w-4 h-4 mr-2"})]),_:1})])):B("",!0)])]),_:1}),t(s(H),{class:"w-full mt-4"},{title:a(()=>[o("div",_e,[t(s(K),{class:"w-4 h-4"}),e[23]||(e[23]=o("span",null,"Decodificar bytes hex a texto",-1))])]),subtitle:a(()=>e[24]||(e[24]=[k(" Convierte una secuencia de bytes en formato 0xNN,0xNN,... a texto legible (UTF-8) ")])),content:a(()=>[o("div",De,[o("div",null,[e[25]||(e[25]=o("label",{class:"block mb-2"},"Bytes hexadecimales",-1)),t(s(C),null,{default:a(()=>[t(s(h),null,{default:a(()=>[t(s(K),{class:"w-4 h-4"})]),_:1}),t(s(_),{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=r=>p.value=r),rows:"3",class:"w-full",placeholder:"Ejemplo: 0x7b,0x22,0x6b,0x65,0x79,0x73,0x22,0x3a,0x5b,0x7b,0x22,0x6b,0x74,0x79,0x22,0x3a,0x22,0x6f,0x63,0x74,0x22"},null,8,["modelValue"])]),_:1})]),o("div",Ee,[t(s(n),{label:"Decodificar",class:"p-button-success flex-grow",onClick:J,disabled:!p.value},{icon:a(()=>[t(s(P),{class:"w-4 h-4 mr-2"})]),_:1},8,["disabled"]),T((v(),N(s(n),{class:"p-button-outlined",onClick:e[8]||(e[8]=()=>w(p.value)),disabled:!p.value},{icon:a(()=>[t(s(g),{class:"w-4 h-4"})]),_:1},8,["disabled"])),[[d,"Copiar entrada",void 0,{top:!0}]])]),x.value?(v(),D("div",Be,[e[26]||(e[26]=o("label",{class:"block mb-2"},"Texto decodificado",-1)),t(s(C),null,{default:a(()=>[t(s(h),null,{default:a(()=>[t(s(oe),{class:"w-4 h-4"})]),_:1}),t(s(_),{modelValue:x.value,"onUpdate:modelValue":e[9]||(e[9]=r=>x.value=r),rows:"3",class:"w-full mb-2",readonly:""},null,8,["modelValue"])]),_:1}),t(s(n),{label:"Copiar resultado",class:"p-button-outlined w-full",onClick:e[10]||(e[10]=()=>w(x.value))},{icon:a(()=>[t(s(g),{class:"w-4 h-4 mr-2"})]),_:1})])):B("",!0)])]),_:1})])])])}}}),Ke=te(Ve,[["__scopeId","data-v-431ba2de"]]);export{Ke as default};
