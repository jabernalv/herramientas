import{u as W,h as I,a as d,j as A}from"./primevue-Cz0MYcUz.js";import{P as X,r as g,c as k,e as o,x as l,B as p,j as E,R as a,A as w,t as C,l as H,F as O,h as q,d as D}from"./vue-vendor-DSKsDytq.js";import{_ as z}from"./index-DtjEgks6.js";const G={class:"w-full sm:w-4/5 mx-auto grid grid-cols-1 sm:grid-cols-2 gap-4"},J={class:"space-y-4"},Q={class:"flex gap-2"},Z={key:0,class:"surface-ground border-round p-3"},_={class:"mb-2"},ee={class:"mb-2"},se={class:"mb-2"},oe={key:0,class:"space-y-4"},te={class:"flex items-center gap-2"},le={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},ae={class:"flex items-center gap-2"},re={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},ie={class:"space-y-4"},de={class:"flex gap-2"},ne={key:0},ce={class:"space-y-4"},ue={class:"flex gap-2"},pe={key:0},fe=X({__name:"DrmTools",setup(me){const f=W(),c=g(""),y=g(""),v=g(""),i=g(null),m=g(""),b=g(""),B={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed",PLAYREADY:"9a04f07998404286ab92e65be0885f95",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2"},V=s=>Array.from(s).map(e=>e.toString(16).padStart(2,"0")).join(""),F=()=>{try{if(!c.value)return;const s=atob(c.value),e=new Uint8Array(s.length);for(let S=0;S<s.length;S++)e[S]=s.charCodeAt(S);if(V(e.slice(4,8))!=="70737368")throw new Error("Formato PSSH inválido: header incorrecto");const t=e[8],n=V(e.slice(12,28));let u="Desconocido";n===B.WIDEVINE?u="Widevine":n===B.PLAYREADY?u="PlayReady":n===B.FAIRPLAY&&(u="FairPlay");let T="",N="";if(u==="Widevine"&&t===0){const h=e.slice(34,50);T=V(h),N=btoa(String.fromCharCode.apply(null,[...h]))}i.value={systemId:n,systemName:u,version:t,keyId:T,keyIdBase64:N},f.add({severity:"success",summary:"Éxito",detail:"PSSH decodificado correctamente",life:3e3})}catch(s){f.add({severity:"error",summary:"Error",detail:s instanceof Error?s.message:"Error al decodificar PSSH",life:3e3})}},P=s=>{const e=[];for(let r=0;r<s.length;r+=2)e.push(parseInt(s.slice(r,r+2),16));return e},R=(...s)=>s.flat(),U=s=>{s=s.replace(/=+$/,"");const e=atob(s);let r="";for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);r+=n.toString(16).padStart(2,"0")}return r},K=s=>/^[0-9a-f]{32}$/.test(s),Y=s=>{try{return s=s.replace(/=+$/,""),atob(s).length===16}catch{return!1}},j=()=>{try{if(!y.value)return;let s=y.value.trim().replace(/-/g,"");if(K(s.toLowerCase()))s=s.toLowerCase();else if(Y(s))s=U(s);else throw new Error("El KeyID debe ser una cadena hexadecimal de 32 caracteres o un Base64 válido que represente 16 bytes.");const e=[0,0,0,50,112,115,115,104,0,0,0,0],r=P("edef8ba979d64acea3c827dcd51d21ed"),t=[0,0,0,18,18,16],n=P(s),u=R(e,r,t,n);v.value=btoa(String.fromCharCode.apply(null,u)),f.add({severity:"success",summary:"Éxito",detail:"PSSH codificado correctamente",life:3e3})}catch(s){f.add({severity:"error",summary:"Error",detail:s instanceof Error?s.message:"Error al codificar PSSH",life:3e3})}},x=async s=>{try{await navigator.clipboard.writeText(s),f.add({severity:"success",summary:"Copiado",detail:"Texto copiado al portapapeles",life:3e3})}catch{f.add({severity:"error",summary:"Error",detail:"Error al copiar al portapapeles",life:3e3})}},L=()=>{c.value="",i.value=null},$=()=>{y.value="",v.value=""};function M(){try{if(!m.value)return;if(!/^(0x[0-9a-fA-F]{2})(,0x[0-9a-fA-F]{2})*$/.test(m.value.trim()))throw new Error("Formato inválido. Usa solo bytes hexadecimales con prefijo 0x, separados por coma. Ejemplo: 0x7b,0x22,0x6b,0x65");const r=m.value.trim().split(",").map(u=>parseInt(u,16)),n=new TextDecoder("utf-8").decode(new Uint8Array(r));b.value=n,f.add({severity:"success",summary:"Éxito",detail:"Decodificado correctamente",life:3e3})}catch(s){b.value="",f.add({severity:"error",summary:"Error",detail:s instanceof Error?s.message:"Error al decodificar los bytes",life:3e3})}}return(s,e)=>{const r=q("tooltip");return D(),k(O,null,[e[27]||(e[27]=o("h1",{class:"text-2xl font-bold"},"DRM Tools",-1)),o("div",G,[l(a(A),{class:"w-full"},{title:p(()=>e[11]||(e[11]=[o("div",{class:"flex items-center gap-2"},[o("i",{class:"pi pi-lock-open"}),o("span",null,"Decodificar PSSH")],-1)])),subtitle:p(()=>e[12]||(e[12]=[w("Decodifica un PSSH de formato Base64 ")])),content:p(()=>[o("div",J,[o("div",null,[e[13]||(e[13]=o("label",{class:"block mb-2"},"PSSH Base64",-1)),l(a(I),{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),rows:"3",class:"w-full",placeholder:"Ingrese el PSSH en formato Base64"},null,8,["modelValue"])]),o("div",Q,[l(a(d),{label:"Decodificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:F,disabled:!c.value},null,8,["disabled"]),l(a(d),{icon:"pi pi-copy",class:"p-button-outlined",onClick:e[1]||(e[1]=()=>x(c.value)),disabled:!c.value},null,8,["disabled"]),l(a(d),{icon:"pi pi-trash",severity:"danger",onClick:L,disabled:!c.value&&!i.value},null,8,["disabled"])]),i.value?(D(),k("div",Z,[o("p",_,[e[14]||(e[14]=o("strong",null,"Sistema DRM:",-1)),w(" "+C(i.value.systemName),1)]),o("p",ee,[e[15]||(e[15]=o("strong",null,"System ID:",-1)),w(" "+C(i.value.systemId),1)]),o("p",se,[e[16]||(e[16]=o("strong",null,"Versión:",-1)),w(" "+C(i.value.version),1)]),i.value.keyId?(D(),k("div",oe,[o("div",null,[e[17]||(e[17]=o("p",{class:"font-bold mb-2"},"Key ID (HEX):",-1)),o("div",te,[o("code",le,C(i.value.keyId),1),H(l(a(d),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:e[2]||(e[2]=()=>x(i.value.keyId))},null,512),[[r,"Copiar Key ID (HEX)",void 0,{top:!0}]])])]),o("div",null,[e[18]||(e[18]=o("p",{class:"font-bold mb-2"},"Key ID (Base64):",-1)),o("div",ae,[o("code",re,C(i.value.keyIdBase64),1),H(l(a(d),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:e[3]||(e[3]=()=>x(i.value.keyIdBase64))},null,512),[[r,"Copiar Key ID (Base64)",void 0,{top:!0}]])])])])):E("",!0)])):E("",!0)])]),_:1}),l(a(A),{class:"w-full"},{title:p(()=>e[19]||(e[19]=[o("div",{class:"flex items-center gap-2"},[o("i",{class:"pi pi-lock"}),o("span",null,"Codificar PSSH")],-1)])),subtitle:p(()=>e[20]||(e[20]=[w(" Codifica un Key ID en formato PSSH Base64 ")])),content:p(()=>[o("div",ie,[o("div",null,[e[21]||(e[21]=o("label",{class:"block mb-2"},"Texto a codificar",-1)),l(a(I),{modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=t=>y.value=t),rows:"3",class:"w-full",placeholder:"Ingrese el Key ID en HEX (32 caracteres) o Base64 (22-24 caracteres)"},null,8,["modelValue"])]),o("div",de,[l(a(d),{label:"Codificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:j,disabled:!y.value},null,8,["disabled"]),l(a(d),{icon:"pi pi-trash",severity:"danger",onClick:$,disabled:!y.value&&!v.value},null,8,["disabled"])]),v.value?(D(),k("div",ne,[e[22]||(e[22]=o("label",{class:"block mb-2"},"Resultado en Base64",-1)),l(a(I),{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=t=>v.value=t),rows:"3",class:"w-full mb-2",readonly:""},null,8,["modelValue"]),l(a(d),{icon:"pi pi-copy",label:"Copiar resultado",class:"p-button-outlined w-full",onClick:e[6]||(e[6]=()=>x(v.value))})])):E("",!0)])]),_:1}),l(a(A),{class:"w-full mt-4"},{title:p(()=>e[23]||(e[23]=[o("div",{class:"flex items-center gap-2"},[o("i",{class:"pi pi-code"}),o("span",null,"Decodificar bytes hex a texto")],-1)])),subtitle:p(()=>e[24]||(e[24]=[w(" Convierte una secuencia de bytes en formato 0xNN,0xNN,... a texto legible (UTF-8) ")])),content:p(()=>[o("div",ce,[o("div",null,[e[25]||(e[25]=o("label",{class:"block mb-2"},"Bytes hexadecimales",-1)),l(a(I),{modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=t=>m.value=t),rows:"3",class:"w-full",placeholder:"Ejemplo: 0x7b,0x22,0x6b,0x65,0x79,0x73,0x22,0x3a,0x5b,0x7b,0x22,0x6b,0x74,0x79,0x22,0x3a,0x22,0x6f,0x63,0x74,0x22"},null,8,["modelValue"])]),o("div",ue,[l(a(d),{label:"Decodificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:M,disabled:!m.value},null,8,["disabled"]),H(l(a(d),{icon:"pi pi-copy",class:"p-button-outlined",onClick:e[8]||(e[8]=()=>x(m.value)),disabled:!m.value},null,8,["disabled"]),[[r,"Copiar entrada",void 0,{top:!0}]])]),b.value?(D(),k("div",pe,[e[26]||(e[26]=o("label",{class:"block mb-2"},"Texto decodificado",-1)),l(a(I),{modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=t=>b.value=t),rows:"3",class:"w-full mb-2",readonly:""},null,8,["modelValue"]),l(a(d),{icon:"pi pi-copy",label:"Copiar resultado",class:"p-button-outlined w-full",onClick:e[10]||(e[10]=()=>x(b.value))})])):E("",!0)])]),_:1})])],64)}}}),xe=z(fe,[["__scopeId","data-v-37a7f1f1"]]);export{xe as default};
