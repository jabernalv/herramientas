import{u as $,g as h,f as D,a as c}from"./primevue-Ld5FLyzo.js";import{N as M,r as x,c as I,e as t,x as a,B as y,O as r,F as U,d as k,j as E,A as b,t as g,l as A,h as W}from"./vue-vendor-I0YEQv-f.js";import{_ as X}from"./index-BL9T_QZB.js";const j={class:"flex flex-col items-center min-h-[calc(100vh-4rem)] w-full p-4"},O={class:"w-4/5 space-y-4 flex flex-row gap-4"},q={class:"space-y-4"},z={class:"flex gap-2"},G={key:0,class:"surface-ground border-round p-3"},J={class:"mb-2"},Q={class:"mb-2"},Z={class:"mb-2"},ee={key:0,class:"space-y-4"},se={class:"flex items-center gap-2"},te={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},oe={class:"flex items-center gap-2"},le={class:"bg-surface-200 p-1 rounded flex-grow font-mono text-sm"},ae={class:"space-y-4"},re={class:"flex gap-2"},ie={key:0},ne=M({__name:"DrmTools",setup(de){const m=$(),n=x(""),u=x(""),p=x(""),i=x(null),w={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed",PLAYREADY:"9a04f07998404286ab92e65be0885f95",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2"},C=s=>Array.from(s).map(e=>e.toString(16).padStart(2,"0")).join(""),T=()=>{try{if(!n.value)return;const s=atob(n.value),e=new Uint8Array(s.length);for(let v=0;v<s.length;v++)e[v]=s.charCodeAt(v);if(C(e.slice(4,8))!=="70737368")throw new Error("Formato PSSH inválido: header incorrecto");const o=e[8],d=C(e.slice(12,28));let f="Desconocido";d===w.WIDEVINE?f="Widevine":d===w.PLAYREADY?f="PlayReady":d===w.FAIRPLAY&&(f="FairPlay");let H="",P="";if(f==="Widevine"&&o===0){const V=e.slice(34,50);H=C(V),P=btoa(String.fromCharCode.apply(null,[...V]))}i.value={systemId:d,systemName:f,version:o,keyId:H,keyIdBase64:P},m.add({severity:"success",summary:"Éxito",detail:"PSSH decodificado correctamente",life:3e3})}catch(s){m.add({severity:"error",summary:"Error",detail:s instanceof Error?s.message:"Error al decodificar PSSH",life:3e3})}},B=s=>{const e=[];for(let l=0;l<s.length;l+=2)e.push(parseInt(s.slice(l,l+2),16));return e},_=(...s)=>s.flat(),N=s=>{s=s.replace(/=+$/,"");const e=atob(s);let l="";for(let o=0;o<e.length;o++){const d=e.charCodeAt(o);l+=d.toString(16).padStart(2,"0")}return l},R=s=>/^[0-9a-f]{32}$/.test(s),K=s=>{try{return s=s.replace(/=+$/,""),atob(s).length===16}catch{return!1}},Y=()=>{try{if(!u.value)return;let s=u.value.trim().replace(/-/g,"");if(R(s.toLowerCase()))s=s.toLowerCase();else if(K(s))s=N(s);else throw new Error("El KeyID debe ser una cadena hexadecimal de 32 caracteres o un Base64 válido que represente 16 bytes.");const e=[0,0,0,50,112,115,115,104,0,0,0,0],l=B("edef8ba979d64acea3c827dcd51d21ed"),o=[0,0,0,18,18,16],d=B(s),f=_(e,l,o,d);p.value=btoa(String.fromCharCode.apply(null,f)),m.add({severity:"success",summary:"Éxito",detail:"PSSH codificado correctamente",life:3e3})}catch(s){m.add({severity:"error",summary:"Error",detail:s instanceof Error?s.message:"Error al codificar PSSH",life:3e3})}},S=async s=>{try{await navigator.clipboard.writeText(s),m.add({severity:"success",summary:"Copiado",detail:"Texto copiado al portapapeles",life:3e3})}catch{m.add({severity:"error",summary:"Error",detail:"Error al copiar al portapapeles",life:3e3})}},F=()=>{n.value="",i.value=null},L=()=>{u.value="",p.value=""};return(s,e)=>{const l=W("tooltip");return k(),I(U,null,[e[19]||(e[19]=t("h1",{class:"text-2xl font-bold"},"DRM Tools",-1)),t("div",j,[t("div",O,[a(r(h),{class:"w-full"},{title:y(()=>e[7]||(e[7]=[t("div",{class:"flex items-center gap-2"},[t("i",{class:"pi pi-lock-open"}),t("span",null,"Decodificar PSSH")],-1)])),subtitle:y(()=>e[8]||(e[8]=[b("Decodifica un PSSH en formato Base64 ")])),content:y(()=>[t("div",q,[t("div",null,[e[9]||(e[9]=t("label",{class:"block mb-2"},"PSSH Base64",-1)),a(r(D),{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),rows:"3",class:"w-full",placeholder:"Ingresa el PSSH en formato Base64"},null,8,["modelValue"])]),t("div",z,[a(r(c),{label:"Decodificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:T,disabled:!n.value},null,8,["disabled"]),a(r(c),{icon:"pi pi-copy",class:"p-button-outlined",onClick:e[1]||(e[1]=()=>S(n.value)),disabled:!n.value},null,8,["disabled"]),a(r(c),{icon:"pi pi-trash",severity:"danger",onClick:F,disabled:!n.value&&!i.value},null,8,["disabled"])]),i.value?(k(),I("div",G,[t("p",J,[e[10]||(e[10]=t("strong",null,"Sistema DRM:",-1)),b(" "+g(i.value.systemName),1)]),t("p",Q,[e[11]||(e[11]=t("strong",null,"System ID:",-1)),b(" "+g(i.value.systemId),1)]),t("p",Z,[e[12]||(e[12]=t("strong",null,"Versión:",-1)),b(" "+g(i.value.version),1)]),i.value.keyId?(k(),I("div",ee,[t("div",null,[e[13]||(e[13]=t("p",{class:"font-bold mb-2"},"Key ID (HEX):",-1)),t("div",se,[t("code",te,g(i.value.keyId),1),A(a(r(c),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:e[2]||(e[2]=()=>S(i.value.keyId))},null,512),[[l,"Copiar Key ID (HEX)",void 0,{top:!0}]])])]),t("div",null,[e[14]||(e[14]=t("p",{class:"font-bold mb-2"},"Key ID (Base64):",-1)),t("div",oe,[t("code",le,g(i.value.keyIdBase64),1),A(a(r(c),{icon:"pi pi-copy",class:"p-button-text p-button-sm",onClick:e[3]||(e[3]=()=>S(i.value.keyIdBase64))},null,512),[[l,"Copiar Key ID (Base64)",void 0,{top:!0}]])])])])):E("",!0)])):E("",!0)])]),_:1}),a(r(h),{class:"w-full"},{title:y(()=>e[15]||(e[15]=[t("div",{class:"flex items-center gap-2"},[t("i",{class:"pi pi-lock"}),t("span",null,"Codificar PSSH")],-1)])),subtitle:y(()=>e[16]||(e[16]=[b(" Codifica información en formato PSSH Base64 ")])),content:y(()=>[t("div",ae,[t("div",null,[e[17]||(e[17]=t("label",{class:"block mb-2"},"Texto a codificar",-1)),a(r(D),{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=o=>u.value=o),rows:"3",class:"w-full",placeholder:"Ingresa el Key ID en formato HEX (32 caracteres) o Base64 (22-24 caracteres)"},null,8,["modelValue"])]),t("div",re,[a(r(c),{label:"Codificar",icon:"pi pi-arrow-right",class:"p-button-success flex-grow",onClick:Y,disabled:!u.value},null,8,["disabled"]),a(r(c),{icon:"pi pi-trash",severity:"danger",onClick:L,disabled:!u.value&&!p.value},null,8,["disabled"])]),p.value?(k(),I("div",ie,[e[18]||(e[18]=t("label",{class:"block mb-2"},"Resultado en Base64",-1)),a(r(D),{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=o=>p.value=o),rows:"3",class:"w-full mb-2",readonly:""},null,8,["modelValue"]),a(r(c),{icon:"pi pi-copy",label:"Copiar resultado",class:"p-button-outlined w-full",onClick:e[6]||(e[6]=()=>S(p.value))})])):E("",!0)])]),_:1})])])],64)}}}),fe=X(ne,[["__scopeId","data-v-1e766883"]]);export{fe as default};
