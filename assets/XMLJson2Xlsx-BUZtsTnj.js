import{u as E,H as g,j as w,k as h,l as V,a as O,m as j}from"./primevue-CxRYVc5z.js";import{u as x,w as T}from"./xlsx-BWspZQq9.js";import{F as D}from"./file-text-DFBqC5Jw.js";import{P as M,r as y,c as J,e as l,x as a,B as d,A as _,f as S,R as n,d as X}from"./vue-vendor-jWyGKli5.js";import{_ as A}from"./index-lWU7RDh4.js";const C={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},L={class:"text-sm","aria-label":"Miga de pan"},P={class:"list-none p-0 inline-flex space-x-2"},$={class:"flex items-center"},k={class:"w-full lg:w-4/5 mx-auto mb-16"},B={class:"flex gap-4 mb-4 justify-center"},F={class:"flex items-center"},I={class:"flex items-center"},U={class:"mb-4"},q=M({__name:"XMLJson2Xlsx",setup(H){const c=E(),u=y(""),i=y("json"),m=y(!1),b=(s,e)=>{if(!s.trim())return c.add({severity:"error",summary:"Error",detail:"Por favor, ingresa algún contenido para convertir",life:3e3}),!1;try{if(e==="json")JSON.parse(s);else if(new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("parsererror").length>0)throw new Error("XML inválido");return!0}catch{return c.add({severity:"error",summary:"Error de formato",detail:`El ${e.toUpperCase()} ingresado no es válido`,life:3e3}),!1}},p=(s,e="")=>Object.keys(s).reduce((r,t)=>{const o=e.length?e+".":"";return typeof s[t]=="object"&&s[t]!==null&&!Array.isArray(s[t])?Object.assign(r,p(s[t],o+t)):Array.isArray(s[t])?r[o+t]=JSON.stringify(s[t]):r[o+t]=s[t],r},{}),N=async()=>{if(b(u.value,i.value)){m.value=!0;try{let s;if(i.value==="json"){const t=JSON.parse(u.value);s=[p(t)]}else{const o=new DOMParser().parseFromString(u.value,"text/xml"),v=f(o);s=[p(v)]}const e=x.json_to_sheet(s),r=x.book_new();x.book_append_sheet(r,e,"Datos"),T(r,`conversion_${Date.now()}.xlsx`),c.add({severity:"success",summary:"Éxito",detail:"Archivo Excel generado correctamente",life:3e3})}catch(s){console.error("Error en la conversión:",s),c.add({severity:"error",summary:"Error",detail:"Error al generar el archivo Excel",life:3e3})}finally{m.value=!1}}},f=s=>{const e={};if(s.nodeType===Node.ELEMENT_NODE){const r=s;if(r.hasAttributes()){e["@attributes"]={};for(let t=0;t<r.attributes.length;t++){const o=r.attributes[t];e["@attributes"][o.nodeName]=o.nodeValue}}}else if(s.nodeType===Node.TEXT_NODE)return s.nodeValue;if(s.hasChildNodes())for(let r=0;r<s.childNodes.length;r++){const t=s.childNodes[r],o=t.nodeName;if(o!=="#text")if(typeof e[o]>"u")e[o]=f(t);else{if(!Array.isArray(e[o])){const v=e[o];e[o]=[v]}e[o].push(f(t))}else if(t.nodeValue?.trim())return t.nodeValue}return e};return(s,e)=>{const r=S("router-link");return X(),J("div",null,[l("div",C,[l("nav",L,[l("ol",P,[l("li",$,[a(r,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:d(()=>e[3]||(e[3]=[l("i",{class:"inline-block w-4 h-4 mr-1 align-text-bottom"},null,-1),_(" Herramientas ")])),_:1,__:[3]})]),e[4]||(e[4]=l("li",null,[l("i",{class:"inline-block w-4 h-4 text-gray-400 align-text-bottom"})],-1)),e[5]||(e[5]=l("li",{class:"text-gray-700"},"Convertidor XML/JSON a Excel",-1))])])]),l("main",k,[a(n(j),null,{title:d(()=>e[6]||(e[6]=[_(" Convertidor XML/JSON a Excel ")])),content:d(()=>[l("div",B,[l("div",F,[a(n(g),{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value=t),inputId:"json",name:"type",value:"json"},null,8,["modelValue"]),e[7]||(e[7]=l("label",{for:"json",class:"ml-2 cursor-pointer"},"JSON",-1))]),l("div",I,[a(n(g),{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=t=>i.value=t),inputId:"xml",name:"type",value:"xml"},null,8,["modelValue"]),e[8]||(e[8]=l("label",{for:"xml",class:"ml-2 cursor-pointer"},"XML",-1))])]),l("div",U,[a(n(w),null,{default:d(()=>[a(n(h),null,{default:d(()=>[a(n(D),{class:"text-gray-500"})]),_:1}),a(n(V),{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=t=>u.value=t),placeholder:i.value==="json"?`{
  "ejemplo": "Pega tu JSON aquí"
}`:`<?xml version="1.0"?>
<root>
  <ejemplo>Pega tu XML aquí</ejemplo>
</root>`,rows:"12",class:"w-full font-mono"},null,8,["modelValue","placeholder"])]),_:1})]),a(n(O),{onClick:N,icon:"pi pi-file-excel",label:"Convertir a Excel",severity:"success",loading:m.value,class:"w-full"},null,8,["loading"])]),_:1})])])}}}),W=A(q,[["__scopeId","data-v-8cc218de"]]);export{W as default};
