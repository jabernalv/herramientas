import{u as b,D as y,h as N,a as E}from"./primevue-CnIjzyZF.js";import{u as x,w as h}from"./xlsx-BWspZQq9.js";import{O as w,r as v,c as V,e as o,x as i,B as O,A as j,f as D,Q as d,d as T}from"./vue-vendor-CjDfc70Z.js";import{_ as M}from"./index-pjW8PsHN.js";const J={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},S={class:"text-sm","aria-label":"Miga de pan"},X={class:"list-none p-0 inline-flex space-x-2"},A={class:"flex items-center"},C={class:"w-full lg:w-4/5 mx-auto mb-16"},L={class:"card"},P={class:"flex gap-4 mb-4 justify-center"},B={class:"flex items-center"},k={class:"flex items-center"},I={class:"mb-4"},U=w({__name:"XMLJson2Xlsx",setup($){const u=b(),n=v(""),a=v("json"),c=v(!1),g=(s,e)=>{if(!s.trim())return u.add({severity:"error",summary:"Error",detail:"Por favor, ingresa algún contenido para convertir",life:3e3}),!1;try{if(e==="json")JSON.parse(s);else if(new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("parsererror").length>0)throw new Error("XML inválido");return!0}catch{return u.add({severity:"error",summary:"Error de formato",detail:`El ${e.toUpperCase()} ingresado no es válido`,life:3e3}),!1}},m=(s,e="")=>Object.keys(s).reduce((r,t)=>{const l=e.length?e+".":"";return typeof s[t]=="object"&&s[t]!==null&&!Array.isArray(s[t])?Object.assign(r,m(s[t],l+t)):Array.isArray(s[t])?r[l+t]=JSON.stringify(s[t]):r[l+t]=s[t],r},{}),_=async()=>{if(g(n.value,a.value)){c.value=!0;try{let s;if(a.value==="json"){const t=JSON.parse(n.value);s=[m(t)]}else{const l=new DOMParser().parseFromString(n.value,"text/xml"),f=p(l);s=[m(f)]}const e=x.json_to_sheet(s),r=x.book_new();x.book_append_sheet(r,e,"Datos"),h(r,`conversion_${Date.now()}.xlsx`),u.add({severity:"success",summary:"Éxito",detail:"Archivo Excel generado correctamente",life:3e3})}catch(s){console.error("Error en la conversión:",s),u.add({severity:"error",summary:"Error",detail:"Error al generar el archivo Excel",life:3e3})}finally{c.value=!1}}},p=s=>{const e={};if(s.nodeType===Node.ELEMENT_NODE){const r=s;if(r.hasAttributes()){e["@attributes"]={};for(let t=0;t<r.attributes.length;t++){const l=r.attributes[t];e["@attributes"][l.nodeName]=l.nodeValue}}}else if(s.nodeType===Node.TEXT_NODE)return s.nodeValue;if(s.hasChildNodes())for(let r=0;r<s.childNodes.length;r++){const t=s.childNodes[r],l=t.nodeName;if(l!=="#text")if(typeof e[l]>"u")e[l]=p(t);else{if(!Array.isArray(e[l])){const f=e[l];e[l]=[f]}e[l].push(p(t))}else if(t.nodeValue?.trim())return t.nodeValue}return e};return(s,e)=>{const r=D("router-link");return T(),V("div",null,[o("div",J,[o("nav",S,[o("ol",X,[o("li",A,[i(r,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:O(()=>e[3]||(e[3]=[o("i",{class:"inline-block w-4 h-4 mr-1 align-text-bottom"},null,-1),j(" Herramientas ")])),_:1,__:[3]})]),e[4]||(e[4]=o("li",null,[o("i",{class:"inline-block w-4 h-4 text-gray-400 align-text-bottom"})],-1)),e[5]||(e[5]=o("li",{class:"text-gray-700"},"Convertidor XML/JSON a Excel",-1))])])]),o("main",C,[o("div",L,[e[8]||(e[8]=o("h1",{class:"text-2xl font-bold mb-6 text-center text-primary-800"}," Convertidor XML/JSON a Excel ",-1)),o("div",P,[o("div",B,[i(d(y),{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value=t),inputId:"json",name:"type",value:"json"},null,8,["modelValue"]),e[6]||(e[6]=o("label",{for:"json",class:"ml-2 cursor-pointer"},"JSON",-1))]),o("div",k,[i(d(y),{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value=t),inputId:"xml",name:"type",value:"xml"},null,8,["modelValue"]),e[7]||(e[7]=o("label",{for:"xml",class:"ml-2 cursor-pointer"},"XML",-1))])]),o("div",I,[i(d(N),{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value=t),placeholder:a.value==="json"?`{
  "ejemplo": "Pega tu JSON aquí"
}`:`<?xml version="1.0"?>
<root>
  <ejemplo>Pega tu XML aquí</ejemplo>
</root>`,rows:"12",class:"w-full font-mono"},null,8,["modelValue","placeholder"])]),i(d(E),{onClick:_,icon:"pi pi-file-excel",label:"Convertir a Excel",severity:"success",loading:c.value,class:"w-full"},null,8,["loading"])])])])}}}),z=M(U,[["__scopeId","data-v-774c42d2"]]);export{z as default};
