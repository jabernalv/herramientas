import{u as E,p as _,f as w,g as V,k as h,a as b,m as O}from"./primevue-DrPXlnFP.js";import{_ as T}from"./BreadcrumbNav.vue_vue_type_script_setup_true_lang-C1ElsLfU.js";import{u as x,w as j}from"./xlsx-BWspZQq9.js";import{a as D,_ as A}from"./index-C99OtVWq.js";import{P as J,r as y,c as M,x as l,e as i,B as d,R as a,d as S,A as X}from"./vue-vendor-D8N656sj.js";const $={class:"w-full lg:w-4/5 mx-auto mb-16"},C={class:"flex gap-4 mb-4 justify-center"},L={class:"flex items-center"},P={class:"flex items-center"},B={class:"mb-4"},F=J({__name:"XMLJson2Xlsx",setup(I){const c=E(),u=y(""),n=y("json"),m=y(!1),g=(r,e)=>{if(!r.trim())return c.add({severity:"error",summary:"Error",detail:"Por favor, ingresa algún contenido para convertir",life:3e3}),!1;try{if(e==="json")JSON.parse(r);else if(new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("parsererror").length>0)throw new Error("XML inválido");return!0}catch{return c.add({severity:"error",summary:"Error de formato",detail:`El ${e.toUpperCase()} ingresado no es válido`,life:3e3}),!1}},p=(r,e="")=>Object.keys(r).reduce((s,t)=>{const o=e.length?e+".":"";return typeof r[t]=="object"&&r[t]!==null&&!Array.isArray(r[t])?Object.assign(s,p(r[t],o+t)):Array.isArray(r[t])?s[o+t]=JSON.stringify(r[t]):s[o+t]=r[t],s},{}),N=async()=>{if(g(u.value,n.value)){m.value=!0;try{let r;if(n.value==="json"){const t=JSON.parse(u.value);r=[p(t)]}else{const o=new DOMParser().parseFromString(u.value,"text/xml"),v=f(o);r=[p(v)]}const e=x.json_to_sheet(r),s=x.book_new();x.book_append_sheet(s,e,"Datos"),j(s,`conversion_${Date.now()}.xlsx`),c.add({severity:"success",summary:"Éxito",detail:"Archivo Excel generado correctamente",life:3e3})}catch(r){console.error("Error en la conversión:",r),c.add({severity:"error",summary:"Error",detail:"Error al generar el archivo Excel",life:3e3})}finally{m.value=!1}}},f=r=>{const e={};if(r.nodeType===Node.ELEMENT_NODE){const s=r;if(s.hasAttributes()){e["@attributes"]={};for(let t=0;t<s.attributes.length;t++){const o=s.attributes[t];e["@attributes"][o.nodeName]=o.nodeValue}}}else if(r.nodeType===Node.TEXT_NODE)return r.nodeValue;if(r.hasChildNodes())for(let s=0;s<r.childNodes.length;s++){const t=r.childNodes[s],o=t.nodeName;if(o!=="#text")if(typeof e[o]>"u")e[o]=f(t);else{if(!Array.isArray(e[o])){const v=e[o];e[o]=[v]}e[o].push(f(t))}else if(t.nodeValue?.trim())return t.nodeValue}return e};return(r,e)=>(S(),M("div",null,[l(T),i("main",$,[l(a(O),null,{title:d(()=>e[3]||(e[3]=[X(" Convertidor XML/JSON a Excel ")])),content:d(()=>[i("div",C,[i("div",L,[l(a(_),{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=s=>n.value=s),inputId:"json",name:"type",value:"json"},null,8,["modelValue"]),e[4]||(e[4]=i("label",{for:"json",class:"ml-2 cursor-pointer"},"JSON",-1))]),i("div",P,[l(a(_),{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=s=>n.value=s),inputId:"xml",name:"type",value:"xml"},null,8,["modelValue"]),e[5]||(e[5]=i("label",{for:"xml",class:"ml-2 cursor-pointer"},"XML",-1))])]),i("div",B,[l(a(w),null,{default:d(()=>[l(a(V),null,{default:d(()=>[l(a(D),{class:"text-gray-500"})]),_:1}),l(a(h),{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=s=>u.value=s),placeholder:n.value==="json"?`{
  "ejemplo": "Pega tu JSON aquí"
}`:`<?xml version="1.0"?>
<root>
  <ejemplo>Pega tu XML aquí</ejemplo>
</root>`,rows:"12",class:"w-full font-mono"},null,8,["modelValue","placeholder"])]),_:1})]),l(a(b),{onClick:N,icon:"pi pi-file-excel",label:"Convertir a Excel",severity:"success",loading:m.value,class:"w-full"},null,8,["loading"])]),_:1})])]))}}),G=A(F,[["__scopeId","data-v-36f2749d"]]);export{G as default};
