import{u as E,H as g,j as w,a as h,k as V}from"./primevue-BmZgxRPy.js";import{u as v,w as O}from"./xlsx-BWspZQq9.js";import{P as j,r as x,c as T,e as l,x as n,B as y,A as _,f as D,R as u,d as M}from"./vue-vendor-jWyGKli5.js";import{_ as J}from"./index-CFF5II6L.js";const S={class:"bg-gray-100 py-2 px-4 rounded-md shadow-sm mb-6"},X={class:"text-sm","aria-label":"Miga de pan"},A={class:"list-none p-0 inline-flex space-x-2"},C={class:"flex items-center"},L={class:"w-full lg:w-4/5 mx-auto mb-16"},P={class:"flex gap-4 mb-4 justify-center"},k={class:"flex items-center"},B={class:"flex items-center"},$={class:"mb-4"},I=j({__name:"XMLJson2Xlsx",setup(U){const d=E(),i=x(""),a=x("json"),c=x(!1),b=(s,e)=>{if(!s.trim())return d.add({severity:"error",summary:"Error",detail:"Por favor, ingresa algún contenido para convertir",life:3e3}),!1;try{if(e==="json")JSON.parse(s);else if(new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("parsererror").length>0)throw new Error("XML inválido");return!0}catch{return d.add({severity:"error",summary:"Error de formato",detail:`El ${e.toUpperCase()} ingresado no es válido`,life:3e3}),!1}},m=(s,e="")=>Object.keys(s).reduce((r,t)=>{const o=e.length?e+".":"";return typeof s[t]=="object"&&s[t]!==null&&!Array.isArray(s[t])?Object.assign(r,m(s[t],o+t)):Array.isArray(s[t])?r[o+t]=JSON.stringify(s[t]):r[o+t]=s[t],r},{}),N=async()=>{if(b(i.value,a.value)){c.value=!0;try{let s;if(a.value==="json"){const t=JSON.parse(i.value);s=[m(t)]}else{const o=new DOMParser().parseFromString(i.value,"text/xml"),f=p(o);s=[m(f)]}const e=v.json_to_sheet(s),r=v.book_new();v.book_append_sheet(r,e,"Datos"),O(r,`conversion_${Date.now()}.xlsx`),d.add({severity:"success",summary:"Éxito",detail:"Archivo Excel generado correctamente",life:3e3})}catch(s){console.error("Error en la conversión:",s),d.add({severity:"error",summary:"Error",detail:"Error al generar el archivo Excel",life:3e3})}finally{c.value=!1}}},p=s=>{const e={};if(s.nodeType===Node.ELEMENT_NODE){const r=s;if(r.hasAttributes()){e["@attributes"]={};for(let t=0;t<r.attributes.length;t++){const o=r.attributes[t];e["@attributes"][o.nodeName]=o.nodeValue}}}else if(s.nodeType===Node.TEXT_NODE)return s.nodeValue;if(s.hasChildNodes())for(let r=0;r<s.childNodes.length;r++){const t=s.childNodes[r],o=t.nodeName;if(o!=="#text")if(typeof e[o]>"u")e[o]=p(t);else{if(!Array.isArray(e[o])){const f=e[o];e[o]=[f]}e[o].push(p(t))}else if(t.nodeValue?.trim())return t.nodeValue}return e};return(s,e)=>{const r=D("router-link");return M(),T("div",null,[l("div",S,[l("nav",X,[l("ol",A,[l("li",C,[n(r,{to:"/",class:"text-blue-500 hover:text-blue-700"},{default:y(()=>e[3]||(e[3]=[l("i",{class:"inline-block w-4 h-4 mr-1 align-text-bottom"},null,-1),_(" Herramientas ")])),_:1,__:[3]})]),e[4]||(e[4]=l("li",null,[l("i",{class:"inline-block w-4 h-4 text-gray-400 align-text-bottom"})],-1)),e[5]||(e[5]=l("li",{class:"text-gray-700"},"Convertidor XML/JSON a Excel",-1))])])]),l("main",L,[n(u(V),null,{title:y(()=>e[6]||(e[6]=[_(" Convertidor XML/JSON a Excel ")])),content:y(()=>[l("div",P,[l("div",k,[n(u(g),{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value=t),inputId:"json",name:"type",value:"json"},null,8,["modelValue"]),e[7]||(e[7]=l("label",{for:"json",class:"ml-2 cursor-pointer"},"JSON",-1))]),l("div",B,[n(u(g),{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value=t),inputId:"xml",name:"type",value:"xml"},null,8,["modelValue"]),e[8]||(e[8]=l("label",{for:"xml",class:"ml-2 cursor-pointer"},"XML",-1))])]),l("div",$,[n(u(w),{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=t=>i.value=t),placeholder:a.value==="json"?`{
  "ejemplo": "Pega tu JSON aquí"
}`:`<?xml version="1.0"?>
<root>
  <ejemplo>Pega tu XML aquí</ejemplo>
</root>`,rows:"12",class:"w-full font-mono"},null,8,["modelValue","placeholder"])]),n(u(h),{onClick:N,icon:"pi pi-file-excel",label:"Convertir a Excel",severity:"success",loading:c.value,class:"w-full"},null,8,["loading"])]),_:1})])])}}}),z=J(I,[["__scopeId","data-v-f43f480f"]]);export{z as default};
