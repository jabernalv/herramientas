import{u as E,p as _,f as h,g as w,k as V,a as b,m as O}from"./primevue-DrPXlnFP.js";import{_ as T}from"./BreadcrumbNav.vue_vue_type_script_setup_true_lang-CyOJBHb3.js";import{u as x,w as j}from"./xlsx-BWspZQq9.js";import{a as D,e as S,_ as A}from"./index-BorEcxas.js";import{P as J,r as y,c as M,x as a,e as i,B as c,R as l,d as X,A as $}from"./vue-vendor-D8N656sj.js";const C={class:"w-full lg:w-4/5 mx-auto mb-16"},L={class:"flex gap-4 mb-4 justify-center"},P={class:"flex items-center"},B={class:"flex items-center"},F={class:"mb-4"},I=J({__name:"XMLJson2Xlsx",setup(U){const d=E(),u=y(""),n=y("json"),m=y(!1),g=(r,e)=>{if(!r.trim())return d.add({severity:"error",summary:"Error",detail:"Por favor, ingresa algún contenido para convertir",life:3e3}),!1;try{if(e==="json")JSON.parse(r);else if(new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("parsererror").length>0)throw new Error("XML inválido");return!0}catch{return d.add({severity:"error",summary:"Error de formato",detail:`El ${e.toUpperCase()} ingresado no es válido`,life:3e3}),!1}},p=(r,e="")=>Object.keys(r).reduce((t,s)=>{const o=e.length?e+".":"";return typeof r[s]=="object"&&r[s]!==null&&!Array.isArray(r[s])?Object.assign(t,p(r[s],o+s)):Array.isArray(r[s])?t[o+s]=JSON.stringify(r[s]):t[o+s]=r[s],t},{}),N=async()=>{if(g(u.value,n.value)){m.value=!0;try{let r;if(n.value==="json"){const s=JSON.parse(u.value);r=[p(s)]}else{const o=new DOMParser().parseFromString(u.value,"text/xml"),v=f(o);r=[p(v)]}const e=x.json_to_sheet(r),t=x.book_new();x.book_append_sheet(t,e,"Datos"),j(t,`conversion_${Date.now()}.xlsx`),d.add({severity:"success",summary:"Éxito",detail:"Archivo Excel generado correctamente",life:3e3})}catch(r){console.error("Error en la conversión:",r),d.add({severity:"error",summary:"Error",detail:"Error al generar el archivo Excel",life:3e3})}finally{m.value=!1}}},f=r=>{const e={};if(r.nodeType===Node.ELEMENT_NODE){const t=r;if(t.hasAttributes()){e["@attributes"]={};for(let s=0;s<t.attributes.length;s++){const o=t.attributes[s];e["@attributes"][o.nodeName]=o.nodeValue}}}else if(r.nodeType===Node.TEXT_NODE)return r.nodeValue;if(r.hasChildNodes())for(let t=0;t<r.childNodes.length;t++){const s=r.childNodes[t],o=s.nodeName;if(o!=="#text")if(typeof e[o]>"u")e[o]=f(s);else{if(!Array.isArray(e[o])){const v=e[o];e[o]=[v]}e[o].push(f(s))}else if(s.nodeValue?.trim())return s.nodeValue}return e};return(r,e)=>(X(),M("div",null,[a(T),i("main",C,[a(l(O),null,{title:c(()=>e[3]||(e[3]=[$(" Convertidor XML/JSON a Excel ")])),content:c(()=>[i("div",L,[i("div",P,[a(l(_),{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),inputId:"json",name:"type",value:"json"},null,8,["modelValue"]),e[4]||(e[4]=i("label",{for:"json",class:"ml-2 cursor-pointer"},"JSON",-1))]),i("div",B,[a(l(_),{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value=t),inputId:"xml",name:"type",value:"xml"},null,8,["modelValue"]),e[5]||(e[5]=i("label",{for:"xml",class:"ml-2 cursor-pointer"},"XML",-1))])]),i("div",F,[a(l(h),null,{default:c(()=>[a(l(w),null,{default:c(()=>[a(l(D),{class:"text-gray-500"})]),_:1}),a(l(V),{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=t=>u.value=t),placeholder:n.value==="json"?`{
  "ejemplo": "Pega tu JSON aquí"
}`:`<?xml version="1.0"?>
<root>
  <ejemplo>Pega tu XML aquí</ejemplo>
</root>`,rows:"12",class:"w-full font-mono"},null,8,["modelValue","placeholder"])]),_:1})]),a(l(b),{onClick:N,label:"Convertir a Excel",severity:"success",loading:m.value,class:"w-full"},{icon:c(()=>[a(l(S),{class:"w-4 h-4 mr-2"})]),_:1},8,["loading"])]),_:1})])]))}}),H=A(I,[["__scopeId","data-v-ed3cf3a5"]]);export{H as default};
