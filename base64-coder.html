<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Base64 Codificador/Decodificador</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <style>
      .file-upload-wrapper {
        position: relative;
        overflow: hidden;
        display: inline-block;
      }

      .file-upload-wrapper input[type="file"] {
        font-size: 100px;
        position: absolute;
        left: 0;
        top: 0;
        opacity: 0;
      }
    </style>
  </head>
  <body class="bg-gray-100 min-h-screen font-sans antialiased">
    <div class="container mx-auto py-12 px-4 sm:px-6 lg:px-8">
      <header class="text-center mb-8">
        <h1 class="text-3xl font-extrabold text-blue-700 mb-2">
          <i data-lucide="code" class="inline-block w-8 h-8 mr-2"></i>
          Base64 Codificador/Decodificador
        </h1>
        <p class="text-lg text-gray-600">
          Codifica y decodifica texto y archivos (imágenes) a/desde Base64
          directamente en tu navegador.
        </p>
      </header>

      <main class="grid grid-cols-1 gap-6">
        <div class="bg-white rounded-xl shadow-md p-6">
          <h2 class="text-xl font-semibold text-gray-800 mb-4">
            <i data-lucide="text" class="inline-block w-5 h-5 mr-2"></i>
            Texto
          </h2>
          <div class="mb-4">
            <label
              for="textInput"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Ingresa el texto:</label
            >
            <textarea
              id="textInput"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              rows="4"
              placeholder="Texto a codificar o decodificar"
            ></textarea>
          </div>
          <div class="flex space-x-4 mb-4">
            <button
              id="encodeTextBtn"
              class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
            >
              Codificar a Base64
            </button>
            <button
              id="decodeTextBtn"
              class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
            >
              Decodificar desde Base64
            </button>
          </div>
          <div>
            <label
              for="textOutput"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Resultado:</label
            >
            <textarea
              id="textOutput"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              rows="4"
              readonly
            ></textarea>
          </div>
        </div>

        <div class="bg-white rounded-xl shadow-md p-6">
          <h2 class="text-xl font-semibold text-gray-800 mb-4">
            <i data-lucide="image" class="inline-block w-5 h-5 mr-2"></i>
            Imagen
          </h2>
          <div class="mb-4">
            <label
              for="imageInput"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Selecciona una imagen:</label
            >
            <div class="file-upload-wrapper bg-blue-200 hover:bg-blue-300 text-blue-800 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline cursor-pointer">
              <i data-lucide="upload" class="inline-block w-5 h-5 mr-2"></i>
              <span>Subir Imagen</span>
              <input type="file" id="imageInput" accept="image/*" />
            </div>
          </div>
          <div class="mb-4">
            <label
              for="imageOutput"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Resultado Base64 (Data URL):</label
            >
            <textarea
              id="imageOutput"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              rows="4"
              readonly
              placeholder="La representación Base64 de la imagen aparecerá aquí"
            ></textarea>
          </div>
          <div id="imagePreview" class="mt-4">
            <h3 class="text-lg font-semibold text-gray-800 mb-2">
              Vista previa de la imagen (si es válida):
            </h3>
            <img id="preview" src="#" alt="Vista previa" class="hidden max-w-full h-auto rounded-md" />
          </div>
        </div>
      </main>

      <footer class="text-center mt-12 text-gray-500 text-sm">
        <p>&copy; 2025 Mi Caja de Herramientas Web</p>
      </footer>
    </div>

    <script>
      lucide.createIcons();

      const textInput = document.getElementById('textInput');
      const textOutput = document.getElementById('textOutput');
      const encodeTextBtn = document.getElementById('encodeTextBtn');
      const decodeTextBtn = document.getElementById('decodeTextBtn');
      const imageInput = document.getElementById('imageInput');
      const imageOutput = document.getElementById('imageOutput');
      const previewImage = document.getElementById('preview');

      encodeTextBtn.addEventListener('click', () => {
        const text = textInput.value;
        const base64 = btoa(text);
        textOutput.value = base64;
      });

      decodeTextBtn.addEventListener('click', () => {
        try {
          const base64 = textInput.value;
          const text = atob(base64);
          textOutput.value = text;
        } catch (error) {
          textOutput.value = '⚠️ Base64 inválido';
        }
      });

      imageInput.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onloadend = () => {
            imageOutput.value = reader.result;
            previewImage.src = reader.result;
            previewImage.classList.remove('hidden');
          };
          reader.readAsDataURL(file); // Lee el archivo como una Data URL (base64)
        } else {
          imageOutput.value = '';
          previewImage.src = '#';
          previewImage.classList.add('hidden');
        }
      });
    </script>
  </body>
</html>
